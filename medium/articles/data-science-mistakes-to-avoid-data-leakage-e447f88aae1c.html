<article class="meteredContent"><div class="l"><div class="gg gh gi gj gk gl gm ce gn ch l"></div><div class="l"><header class="pw-post-byline-header go gp gq gr gs gt gu gv gw gx l"><div class="o gy u"><div class="o"><div class="fj l"><a class="au av aw ax ay az ba bb bc bd be bf bg bh bi" href="https://medium.com/@DataScienceRebalanced?source=post_page-----e447f88aae1c--------------------------------" rel="noopener follow"><div class="l do"><img alt="Leah Berg and Ray McLendon" class="l ch fl gz ha fp" height="48" loading="lazy" src="https://miro.medium.com/fit/c/96/96/1*eROj7eqca0MgwLB0Rv_iQQ.png" width="48"/><div class="fk fl l gz ha fo aq"></div></div></a></div><div class="l"><div class="pw-author bm b dm dn ga"><div class="hb o hc"><div><div aria-hidden="false" class="ci"><a class="au av aw ax ay az ba bb bc bd be bf bg bh bi" href="https://medium.com/@DataScienceRebalanced?source=post_page-----e447f88aae1c--------------------------------" rel="noopener follow">Leah Berg and Ray McLendon</a></div></div><div class="hd he hf hg hh d"><span><a class="bm b hi bo hj hk hl hm hn ho hp bd bz hq hr hs cd cf cg ch ci cj" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F52338acfb4b9&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-mistakes-to-avoid-data-leakage-e447f88aae1c&amp;user=Leah+Berg+and+Ray+McLendon&amp;userId=52338acfb4b9&amp;source=post_page-52338acfb4b9----e447f88aae1c---------------------follow_byline-----------" rel="noopener follow">Follow</a></span></div></div></div><div class="o ao ht"><p class="pw-published-date bm b bn bo cn"><span>Jan 29</span></p><div aria-hidden="true" class="hu ci"><span aria-hidden="true" class="l"><span class="bm b bn bo cn">·</span></span></div><div class="pw-reading-time bm b bn bo cn">14 min read</div><div aria-hidden="true" class="hu ci"><span aria-hidden="true" class="l"><span class="bm b bn bo cn">·</span></span></div><div class="hx l"><div aria-hidden="false" class="l"><button class="l dz hv bb"><div class="j i d"><div><div aria-hidden="false" class="ci"><svg fill="none" height="20" viewbox="0 0 20 20" width="20"><path d="M12.4 12.77l-1.81 4.99a.63.63 0 0 1-1.18 0l-1.8-4.99a.63.63 0 0 0-.38-.37l-4.99-1.81a.62.62 0 0 1 0-1.18l4.99-1.8a.63.63 0 0 0 .37-.38l1.81-4.99a.63.63 0 0 1 1.18 0l1.8 4.99a.63.63 0 0 0 .38.37l4.99 1.81a.63.63 0 0 1 0 1.18l-4.99 1.8a.63.63 0 0 0-.37.38z" fill="#FFC017"></path></svg></div></div></div><div class="h k hy hz ia"><svg class="hw" fill="none" height="20" viewbox="0 0 20 20" width="20"><path d="M12.4 12.77l-1.81 4.99a.63.63 0 0 1-1.18 0l-1.8-4.99a.63.63 0 0 0-.38-.37l-4.99-1.81a.62.62 0 0 1 0-1.18l4.99-1.8a.63.63 0 0 0 .37-.38l1.81-4.99a.63.63 0 0 1 1.18 0l1.8 4.99a.63.63 0 0 0 .38.37l4.99 1.81a.63.63 0 0 1 0 1.18l-4.99 1.8a.63.63 0 0 0-.37.38z" fill="#FFC017"></path></svg><p class="bm b bn bo cn">Member-only</p></div></button></div></div></div></div></div><div class="o ao"><div class="h k ib ic id"><div class="ie l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on twitter" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M20 5.34c-.67.41-1.4.7-2.18.87a3.45 3.45 0 0 0-5.02-.1 3.49 3.49 0 0 0-1.02 2.47c0 .28.03.54.07.8a9.91 9.91 0 0 1-7.17-3.66 3.9 3.9 0 0 0-.5 1.74 3.6 3.6 0 0 0 1.56 2.92 3.36 3.36 0 0 1-1.55-.44V10c0 1.67 1.2 3.08 2.8 3.42-.3.06-.6.1-.94.12l-.62-.06a3.5 3.5 0 0 0 3.24 2.43 7.34 7.34 0 0 1-4.36 1.49l-.81-.05a9.96 9.96 0 0 0 5.36 1.56c6.4 0 9.91-5.32 9.9-9.9v-.5c.69-.49 1.28-1.1 1.74-1.81-.63.3-1.3.48-2 .56A3.33 3.33 0 0 0 20 5.33" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="ie l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on facebook" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M19.75 12.04c0-4.3-3.47-7.79-7.75-7.79a7.77 7.77 0 0 0-5.9 12.84 7.77 7.77 0 0 0 4.69 2.63v-5.49h-1.9v-2.2h1.9v-1.62c0-1.88 1.14-2.9 2.8-2.9.8 0 1.49.06 1.69.08v1.97h-1.15c-.91 0-1.1.43-1.1 1.07v1.4h2.17l-.28 2.2h-1.88v5.52a7.77 7.77 0 0 0 6.7-7.71" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="ie l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on linkedin" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M19.75 5.39v13.22a1.14 1.14 0 0 1-1.14 1.14H5.39a1.14 1.14 0 0 1-1.14-1.14V5.39a1.14 1.14 0 0 1 1.14-1.14h13.22a1.14 1.14 0 0 1 1.14 1.14zM8.81 10.18H6.53v7.3H8.8v-7.3zM9 7.67a1.31 1.31 0 0 0-1.3-1.32h-.04a1.32 1.32 0 0 0 0 2.64A1.31 1.31 0 0 0 9 7.71v-.04zm8.46 5.37c0-2.2-1.4-3.05-2.78-3.05a2.6 2.6 0 0 0-2.3 1.18h-.07v-1h-2.14v7.3h2.28V13.6a1.51 1.51 0 0 1 1.36-1.63h.09c.72 0 1.26.45 1.26 1.6v3.91h2.28l.02-4.43z" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="l fr"><div><div aria-hidden="false" class="ci"><button class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path clip-rule="evenodd" d="M3.57 14.67c0-.57.13-1.11.38-1.6l.02-.02v-.02l.02-.02c0-.02 0-.02.02-.02.12-.26.3-.52.57-.8L7.78 9v-.02l.01-.02c.44-.41.91-.7 1.44-.85a4.87 4.87 0 0 0-1.19 2.36A5.04 5.04 0 0 0 8 11.6L6.04 13.6c-.19.19-.32.4-.38.65a2 2 0 0 0 0 .9c.08.2.2.4.38.57l1.29 1.31c.27.28.62.42 1.03.42.42 0 .78-.14 1.06-.42l1.23-1.25.79-.78 1.15-1.16c.08-.09.19-.22.28-.4.1-.2.15-.42.15-.67 0-.16-.02-.3-.06-.45l-.02-.02v-.02l-.07-.14s0-.03-.04-.06l-.06-.13-.02-.02c0-.02 0-.03-.02-.05a.6.6 0 0 0-.14-.16l-.48-.5c0-.04.02-.1.04-.15l.06-.12 1.17-1.14.09-.09.56.57c.02.04.08.1.16.18l.05.04.03.06.04.05.03.04.04.06.1.14.02.02c0 .02.01.03.03.04l.1.2v.02c.1.16.2.38.3.68a1 1 0 0 1 .04.25 3.2 3.2 0 0 1 .02 1.33 3.49 3.49 0 0 1-.95 1.87l-.66.67-.97.97-1.56 1.57a3.4 3.4 0 0 1-2.47 1.02c-.97 0-1.8-.34-2.49-1.03l-1.3-1.3a3.55 3.55 0 0 1-1-2.51v-.01h-.02v.02zm5.39-3.43c0-.19.02-.4.07-.63.13-.74.44-1.37.95-1.87l.66-.67.97-.98 1.56-1.56c.68-.69 1.5-1.03 2.47-1.03.97 0 1.8.34 2.48 1.02l1.3 1.32a3.48 3.48 0 0 1 1 2.48c0 .58-.11 1.11-.37 1.6l-.02.02v.02l-.02.04c-.14.27-.35.54-.6.8L16.23 15l-.01.02-.01.02c-.44.42-.92.7-1.43.83a4.55 4.55 0 0 0 1.23-3.52L18 10.38c.18-.21.3-.42.35-.65a2.03 2.03 0 0 0-.01-.9 1.96 1.96 0 0 0-.36-.58l-1.3-1.3a1.49 1.49 0 0 0-1.06-.42c-.42 0-.77.14-1.06.4l-1.2 1.27-.8.8-1.16 1.15c-.08.08-.18.21-.29.4a1.66 1.66 0 0 0-.08 1.12l.02.03v.02l.06.14s.01.03.05.06l.06.13.02.02.01.02.01.02c.05.08.1.13.14.16l.47.5c0 .04-.02.09-.04.15l-.06.12-1.15 1.15-.1.08-.56-.56a2.3 2.3 0 0 0-.18-.19c-.02-.01-.02-.03-.02-.04l-.02-.02a.37.37 0 0 1-.1-.12c-.03-.03-.05-.04-.05-.06l-.1-.15-.02-.02-.02-.04-.08-.17v-.02a5.1 5.1 0 0 1-.28-.69 1.03 1.03 0 0 1-.04-.26c-.06-.23-.1-.46-.1-.7v.01z" fill="#A8A8A8" fill-rule="evenodd"></path></svg></span></button></div></div></div><div class="ih o ao"><span><a class="au av aw ax ay az ba bb bc bd be bf bg bh bi" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe447f88aae1c&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-mistakes-to-avoid-data-leakage-e447f88aae1c&amp;source=--------------------------bookmark_header-----------" rel="noopener follow"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" class="au de aw ax ay az ba if bc hv ij ik il"><svg aria-label="Add to list bookmark button" class="ii" fill="none" height="25" viewbox="0 0 25 25" width="25"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="#292929"></path></svg></button></a></span></div></div><div class="ck im"><div><div aria-hidden="false" class="ci"></div></div></div></div></div><div class="in io ip j i d"><div class="fj l"><span><a class="au av aw ax ay az ba bb bc bd be bf bg bh bi" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe447f88aae1c&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-mistakes-to-avoid-data-leakage-e447f88aae1c&amp;source=--------------------------bookmark_header-----------" rel="noopener follow"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" class="au de aw iq ay az ba ir bc hv cd o ao is it il"><svg aria-label="Add to list bookmark button" class="ii" fill="none" height="25" viewbox="0 0 25 25" width="25"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="#292929"></path></svg><p class="bm b bn bo cn">Save</p></button></a></span></div><div class="iu l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on twitter" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M20 5.34c-.67.41-1.4.7-2.18.87a3.45 3.45 0 0 0-5.02-.1 3.49 3.49 0 0 0-1.02 2.47c0 .28.03.54.07.8a9.91 9.91 0 0 1-7.17-3.66 3.9 3.9 0 0 0-.5 1.74 3.6 3.6 0 0 0 1.56 2.92 3.36 3.36 0 0 1-1.55-.44V10c0 1.67 1.2 3.08 2.8 3.42-.3.06-.6.1-.94.12l-.62-.06a3.5 3.5 0 0 0 3.24 2.43 7.34 7.34 0 0 1-4.36 1.49l-.81-.05a9.96 9.96 0 0 0 5.36 1.56c6.4 0 9.91-5.32 9.9-9.9v-.5c.69-.49 1.28-1.1 1.74-1.81-.63.3-1.3.48-2 .56A3.33 3.33 0 0 0 20 5.33" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="iu l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on facebook" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M19.75 12.04c0-4.3-3.47-7.79-7.75-7.79a7.77 7.77 0 0 0-5.9 12.84 7.77 7.77 0 0 0 4.69 2.63v-5.49h-1.9v-2.2h1.9v-1.62c0-1.88 1.14-2.9 2.8-2.9.8 0 1.49.06 1.69.08v1.97h-1.15c-.91 0-1.1.43-1.1 1.07v1.4h2.17l-.28 2.2h-1.88v5.52a7.77 7.77 0 0 0 6.7-7.71" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="iu l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on linkedin" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M19.75 5.39v13.22a1.14 1.14 0 0 1-1.14 1.14H5.39a1.14 1.14 0 0 1-1.14-1.14V5.39a1.14 1.14 0 0 1 1.14-1.14h13.22a1.14 1.14 0 0 1 1.14 1.14zM8.81 10.18H6.53v7.3H8.8v-7.3zM9 7.67a1.31 1.31 0 0 0-1.3-1.32h-.04a1.32 1.32 0 0 0 0 2.64A1.31 1.31 0 0 0 9 7.71v-.04zm8.46 5.37c0-2.2-1.4-3.05-2.78-3.05a2.6 2.6 0 0 0-2.3 1.18h-.07v-1h-2.14v7.3h2.28V13.6a1.51 1.51 0 0 1 1.36-1.63h.09c.72 0 1.26.45 1.26 1.6v3.91h2.28l.02-4.43z" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="l fr"><div><div aria-hidden="false" class="ci"><button class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path clip-rule="evenodd" d="M3.57 14.67c0-.57.13-1.11.38-1.6l.02-.02v-.02l.02-.02c0-.02 0-.02.02-.02.12-.26.3-.52.57-.8L7.78 9v-.02l.01-.02c.44-.41.91-.7 1.44-.85a4.87 4.87 0 0 0-1.19 2.36A5.04 5.04 0 0 0 8 11.6L6.04 13.6c-.19.19-.32.4-.38.65a2 2 0 0 0 0 .9c.08.2.2.4.38.57l1.29 1.31c.27.28.62.42 1.03.42.42 0 .78-.14 1.06-.42l1.23-1.25.79-.78 1.15-1.16c.08-.09.19-.22.28-.4.1-.2.15-.42.15-.67 0-.16-.02-.3-.06-.45l-.02-.02v-.02l-.07-.14s0-.03-.04-.06l-.06-.13-.02-.02c0-.02 0-.03-.02-.05a.6.6 0 0 0-.14-.16l-.48-.5c0-.04.02-.1.04-.15l.06-.12 1.17-1.14.09-.09.56.57c.02.04.08.1.16.18l.05.04.03.06.04.05.03.04.04.06.1.14.02.02c0 .02.01.03.03.04l.1.2v.02c.1.16.2.38.3.68a1 1 0 0 1 .04.25 3.2 3.2 0 0 1 .02 1.33 3.49 3.49 0 0 1-.95 1.87l-.66.67-.97.97-1.56 1.57a3.4 3.4 0 0 1-2.47 1.02c-.97 0-1.8-.34-2.49-1.03l-1.3-1.3a3.55 3.55 0 0 1-1-2.51v-.01h-.02v.02zm5.39-3.43c0-.19.02-.4.07-.63.13-.74.44-1.37.95-1.87l.66-.67.97-.98 1.56-1.56c.68-.69 1.5-1.03 2.47-1.03.97 0 1.8.34 2.48 1.02l1.3 1.32a3.48 3.48 0 0 1 1 2.48c0 .58-.11 1.11-.37 1.6l-.02.02v.02l-.02.04c-.14.27-.35.54-.6.8L16.23 15l-.01.02-.01.02c-.44.42-.92.7-1.43.83a4.55 4.55 0 0 0 1.23-3.52L18 10.38c.18-.21.3-.42.35-.65a2.03 2.03 0 0 0-.01-.9 1.96 1.96 0 0 0-.36-.58l-1.3-1.3a1.49 1.49 0 0 0-1.06-.42c-.42 0-.77.14-1.06.4l-1.2 1.27-.8.8-1.16 1.15c-.08.08-.18.21-.29.4a1.66 1.66 0 0 0-.08 1.12l.02.03v.02l.06.14s.01.03.05.06l.06.13.02.02.01.02.01.02c.05.08.1.13.14.16l.47.5c0 .04-.02.09-.04.15l-.06.12-1.15 1.15-.1.08-.56-.56a2.3 2.3 0 0 0-.18-.19c-.02-.01-.02-.03-.02-.04l-.02-.02a.37.37 0 0 1-.1-.12c-.03-.03-.05-.04-.05-.06l-.1-.15-.02-.02-.02-.04-.08-.17v-.02a5.1 5.1 0 0 1-.28-.69 1.03 1.03 0 0 1-.04-.26c-.06-.23-.1-.46-.1-.7v.01z" fill="#A8A8A8" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></header><span class="l"></span><section><div><div class="fo as ja jb jc jd"></div><div class="je jf jg jh ji"><div class=""><h1 class="pw-post-title jj jk jl bm jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ga" id="6d52">Data Science Mistakes to Avoid: Data Leakage</h1></div><div class=""><h2 class="pw-subtitle-paragraph ki jk jl bm b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz cn" id="0e9e">The silent error that might be ruining your machine learning project</h2></div><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm la"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/0*vq5I-fAIRj-9dRtu 640w, https://miro.medium.com/max/720/0*vq5I-fAIRj-9dRtu 720w, https://miro.medium.com/max/750/0*vq5I-fAIRj-9dRtu 750w, https://miro.medium.com/max/786/0*vq5I-fAIRj-9dRtu 786w, https://miro.medium.com/max/828/0*vq5I-fAIRj-9dRtu 828w, https://miro.medium.com/max/1100/0*vq5I-fAIRj-9dRtu 1100w, https://miro.medium.com/max/1400/0*vq5I-fAIRj-9dRtu 1400w"/><img alt="" class="ce lk ll c" height="509" loading="eager" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Photo by <a class="au lp" href="https://unsplash.com/@ulevik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sasikan Ulevik</a> on <a class="au lp" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="bc59">With Data Scientist consistently named the Sexiest Job of the 21st Century, it’s no surprise that many are flocking to learn skills like Python, mathematics, and machine learning through university degree programs or online boot camps. These programs can be great to learn the basics but are often quite disconnected from the best practices and realities of implementing machine learning in the industry. One topic that is often lacking from these programs is data leakage, i.e., when your machine learning model knows too much. Data leakage is extremely easy to accidentally introduce into your machine learning project and can have serious consequences.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="56a6">In this article, we’ll cover</p><ul class=""><li class="mm mn jl ls b lt lu lw lx lz mo md mp mh mq ml mr ms mt mu ga" id="2a6d"><em class="mv">What is data leakage?</em></li><li class="mm mn jl ls b lt mw lw mx lz my md mz mh na ml mr ms mt mu ga" id="941a"><em class="mv">How does a machine learning model learn?</em></li><li class="mm mn jl ls b lt mw lw mx lz my md mz mh na ml mr ms mt mu ga" id="98d4"><em class="mv">Examples of data leakage and how to prevent them</em></li><li class="mm mn jl ls b lt mw lw mx lz my md mz mh na ml mr ms mt mu ga" id="8742"><em class="mv">Best practices for preventing data leakage</em></li></ul><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="68d1">What is Data Leakage?</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nt km lv lw nu kp ly lz nv mb mc md nw mf mg mh nx mj mk ml je ga" id="38a1">Imagine the following scenario. You’ve spent a couple of weeks building a machine learning model with extremely high precision and recall. You’re super excited, so you deploy your model to production and let it begin to make predictions on live data only to find out your model is making all of the wrong predictions! This ultimately leads to frustrated users and an angry boss knocking at your door. Unbeknownst to you, data leakage may be the culprit of your model’s poor performance in production.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="f9b1">In the machine learning world, data leakage, also known as target leakage, can occur in two different scenarios:</p><ol class=""><li class="mm mn jl ls b lt lu lw lx lz mo md mp mh mq ml ny ms mt mu ga" id="0b52">Your training data includes information about your test set</li><li class="mm mn jl ls b lt mw lw mx lz my md mz mh na ml ny ms mt mu ga" id="fde0">Your model was trained on information that’s not available when it goes into production</li></ol><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="0b44">Before we walk through a few examples of data leakage, let’s cover the basics of how a machine learning model learns.</p><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="a547">How Does a Machine Learning Model Learn?</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nt km lv lw nu kp ly lz nv mb mc md nw mf mg mh nx mj mk ml je ga" id="0601">If you’ve been practicing machine learning for years, you can skip this section. But for anyone newer to machine learning, to train a model, you take all of your available data and split it into two sets — your training set and your test set.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm nz"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*U10KmssXctbyHQ7ST70BXQ.png 640w, https://miro.medium.com/max/720/1*U10KmssXctbyHQ7ST70BXQ.png 720w, https://miro.medium.com/max/750/1*U10KmssXctbyHQ7ST70BXQ.png 750w, https://miro.medium.com/max/786/1*U10KmssXctbyHQ7ST70BXQ.png 786w, https://miro.medium.com/max/828/1*U10KmssXctbyHQ7ST70BXQ.png 828w, https://miro.medium.com/max/1100/1*U10KmssXctbyHQ7ST70BXQ.png 1100w, https://miro.medium.com/max/1400/1*U10KmssXctbyHQ7ST70BXQ.png 1400w"/><img alt="" class="ce lk ll c" height="196" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 1: Splitting your data into two sets — training and test. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="f934">You will train your model on the training set and then verify your results on the test set. There are many ways to split your data into these two sets, but one of the most popular methods is called a random train/test split. This is often what you will use in academia, but we’ll walk through a couple of examples where this method can introduce data leakage.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="38f7">Let’s see an example of a random train/test split.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="gl gm oa"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 277px" srcset="https://miro.medium.com/max/640/1*9eWqASPhvxO3sPlxhuGXRg.png 640w, https://miro.medium.com/max/720/1*9eWqASPhvxO3sPlxhuGXRg.png 720w, https://miro.medium.com/max/750/1*9eWqASPhvxO3sPlxhuGXRg.png 750w, https://miro.medium.com/max/786/1*9eWqASPhvxO3sPlxhuGXRg.png 786w, https://miro.medium.com/max/828/1*9eWqASPhvxO3sPlxhuGXRg.png 828w, https://miro.medium.com/max/1100/1*9eWqASPhvxO3sPlxhuGXRg.png 1100w, https://miro.medium.com/max/554/1*9eWqASPhvxO3sPlxhuGXRg.png 554w"/><img alt="" class="ce lk ll c" height="534" loading="lazy" role="presentation" width="277"/></picture></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 2: Sample movie data with genres. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="cdcc">Here we have some example data of movie names along with their genres. If we wanted to do a random train/test split on this data, we would first decide how much data we want in our training and test sets. There are many ways to do this, but let’s say we choose a 60/40 split, meaning that 60% of our data is in our training set and 40% of our data is in our test set.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="gl gm ob"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 270px" srcset="https://miro.medium.com/max/640/1*zfpMt_FAHcrt24K5kf1stQ.png 640w, https://miro.medium.com/max/720/1*zfpMt_FAHcrt24K5kf1stQ.png 720w, https://miro.medium.com/max/750/1*zfpMt_FAHcrt24K5kf1stQ.png 750w, https://miro.medium.com/max/786/1*zfpMt_FAHcrt24K5kf1stQ.png 786w, https://miro.medium.com/max/828/1*zfpMt_FAHcrt24K5kf1stQ.png 828w, https://miro.medium.com/max/1100/1*zfpMt_FAHcrt24K5kf1stQ.png 1100w, https://miro.medium.com/max/540/1*zfpMt_FAHcrt24K5kf1stQ.png 540w"/><img alt="" class="ce lk ll c" height="534" loading="lazy" role="presentation" width="270"/></picture></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 3: A 60/40 random train/test split of the movie data. Training data is dark green, and test data is light purple. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="f989">In Figure 3, you’ll see we’ve randomly selected six data points for our training set denoted in dark green and four data points for our test set denoted in purple.</p><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="65e6">Example #1 — Don’t Randomly Split Time Series Data</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nt km lv lw nu kp ly lz nv mb mc md nw mf mg mh nx mj mk ml je ga" id="de52">Now that we know how a machine learning model learns and what a random train/test split is, let's walk through our first example of data leakage.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="gl gm oc"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 266px" srcset="https://miro.medium.com/max/640/1*snn7KTkLyURrojaZS-CDgQ.png 640w, https://miro.medium.com/max/720/1*snn7KTkLyURrojaZS-CDgQ.png 720w, https://miro.medium.com/max/750/1*snn7KTkLyURrojaZS-CDgQ.png 750w, https://miro.medium.com/max/786/1*snn7KTkLyURrojaZS-CDgQ.png 786w, https://miro.medium.com/max/828/1*snn7KTkLyURrojaZS-CDgQ.png 828w, https://miro.medium.com/max/1100/1*snn7KTkLyURrojaZS-CDgQ.png 1100w, https://miro.medium.com/max/532/1*snn7KTkLyURrojaZS-CDgQ.png 532w"/><img alt="" class="ce lk ll c" height="538" loading="lazy" role="presentation" width="266"/></picture></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 4: Precipitation in inches for January — October 2020. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="64af">Here we have the number of inches of precipitation for several months in 2020. Let’s say we’re ready to train a model to predict how many inches of precipitation will occur in a given month. You might be tempted to use the random train/test split we covered above, but that would introduce data leakage! Let’s see why.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="c24e">If we split our data randomly using a 60/40 train/test split, it might look something like this.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="gl gm ob"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 270px" srcset="https://miro.medium.com/max/640/1*_2RPUt9SDyaxDEu_EnzgJw.png 640w, https://miro.medium.com/max/720/1*_2RPUt9SDyaxDEu_EnzgJw.png 720w, https://miro.medium.com/max/750/1*_2RPUt9SDyaxDEu_EnzgJw.png 750w, https://miro.medium.com/max/786/1*_2RPUt9SDyaxDEu_EnzgJw.png 786w, https://miro.medium.com/max/828/1*_2RPUt9SDyaxDEu_EnzgJw.png 828w, https://miro.medium.com/max/1100/1*_2RPUt9SDyaxDEu_EnzgJw.png 1100w, https://miro.medium.com/max/540/1*_2RPUt9SDyaxDEu_EnzgJw.png 540w"/><img alt="" class="ce lk ll c" height="534" loading="lazy" role="presentation" width="270"/></picture></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 5: A 60/40 random train/test split of the precipitation data. Training data is dark green, and test data is light purple. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="010a">Let’s say we want to predict how many inches of precipitation we will receive in July. When we go to make this prediction, we’ve already trained our model on August, September, and October’s precipitation, so the model knows what will happen in future months!</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="3a09">Instead of using a random train/test split, we want to use a sliding window. There are several different ways to use sliding windows in time series data, but we’ll just cover one example here.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm od"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*mM25rTa-1yqM1B3EJD2Rhg.png 640w, https://miro.medium.com/max/720/1*mM25rTa-1yqM1B3EJD2Rhg.png 720w, https://miro.medium.com/max/750/1*mM25rTa-1yqM1B3EJD2Rhg.png 750w, https://miro.medium.com/max/786/1*mM25rTa-1yqM1B3EJD2Rhg.png 786w, https://miro.medium.com/max/828/1*mM25rTa-1yqM1B3EJD2Rhg.png 828w, https://miro.medium.com/max/1100/1*mM25rTa-1yqM1B3EJD2Rhg.png 1100w, https://miro.medium.com/max/1400/1*mM25rTa-1yqM1B3EJD2Rhg.png 1400w"/><img alt="" class="ce lk ll c" height="341" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 6: An example of a sliding window. First, the model is trained on January and February data and tested on March data. Then the model is trained on January, February, and March data and tested on April data. The cycle is repeated as many times as desired. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="0f5b">In Figure 6, we first train our model on January and February data, and then use that data to predict March. In our next iteration, we’ll add March to our training set and use January, February, and March to predict April. We repeat this cycle for a set number of iterations and then ultimately aggregate the errors from each iteration into a single error metric.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="1e8d">Pro tip: Always use a sliding window to split time series data!</p><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="ca79">Example #2 — Don’t Include Data From the Future</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nt km lv lw nu kp ly lz nv mb mc md nw mf mg mh nx mj mk ml je ga" id="e809">Let’s extend the previous example by adding more data to try and improve our model. In Figure 7, we’ve added in the high temperature for each month.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="gl gm oe"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 439px" srcset="https://miro.medium.com/max/640/1*kQ3iniH5A0H35BQUc0hz-w.png 640w, https://miro.medium.com/max/720/1*kQ3iniH5A0H35BQUc0hz-w.png 720w, https://miro.medium.com/max/750/1*kQ3iniH5A0H35BQUc0hz-w.png 750w, https://miro.medium.com/max/786/1*kQ3iniH5A0H35BQUc0hz-w.png 786w, https://miro.medium.com/max/828/1*kQ3iniH5A0H35BQUc0hz-w.png 828w, https://miro.medium.com/max/1100/1*kQ3iniH5A0H35BQUc0hz-w.png 1100w, https://miro.medium.com/max/878/1*kQ3iniH5A0H35BQUc0hz-w.png 878w"/><img alt="" class="ce lk ll c" height="539" loading="lazy" role="presentation" width="439"/></picture></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 7: The high temperature for each month has been added to our precipitation data. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="93b6">This seems innocent enough, but it’s a source of data leakage if we include it in our model. If we try to make a prediction at the beginning of the month, our model won’t have the high temperature for the month because the month hasn’t been completed yet!</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="28a7">To prevent this from happening, we recommend that you map events related to your data onto a timeline.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm of"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*3OnQa_-8loUZ4ciw8BF-gA.png 640w, https://miro.medium.com/max/720/1*3OnQa_-8loUZ4ciw8BF-gA.png 720w, https://miro.medium.com/max/750/1*3OnQa_-8loUZ4ciw8BF-gA.png 750w, https://miro.medium.com/max/786/1*3OnQa_-8loUZ4ciw8BF-gA.png 786w, https://miro.medium.com/max/828/1*3OnQa_-8loUZ4ciw8BF-gA.png 828w, https://miro.medium.com/max/1100/1*3OnQa_-8loUZ4ciw8BF-gA.png 1100w, https://miro.medium.com/max/1400/1*3OnQa_-8loUZ4ciw8BF-gA.png 1400w"/><img alt="" class="ce lk ll c" height="233" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 8: A timeline representation of important events related to our precipitation data. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="edfb">Figure 8 what a timeline might look like for our example. On January 1st, our model predicts how many inches of precipitation we will get for that month. Throughout the month, we collect daily precipitation and temperature data until January 31st when the month ends. It’s only when the month <em class="mv">ends</em> that we can calculate the maximum temperature for January.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="3f35">When mapping related events onto a timeline, it’s important to note where the model makes its prediction. Once we find that point, we only want to include information that occurs <strong class="ls jm">before</strong> that point.</p><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="a2f7">Example #3 — Don’t Randomly Split Groups</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nt km lv lw nu kp ly lz nv mb mc md nw mf mg mh nx mj mk ml je ga" id="83a8">Now that we’ve seen a couple of examples with time series data, let’s take a look at a classification problem with data shown in Figure 9. For this example, we have students, essays, and their scores for each essay. Let’s say we want to make a model that will predict a student’s essay score based on the text of their essay.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="gl gm og"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 322px" srcset="https://miro.medium.com/max/640/1*L7autVhrmJ5iQcGptOxO7Q.png 640w, https://miro.medium.com/max/720/1*L7autVhrmJ5iQcGptOxO7Q.png 720w, https://miro.medium.com/max/750/1*L7autVhrmJ5iQcGptOxO7Q.png 750w, https://miro.medium.com/max/786/1*L7autVhrmJ5iQcGptOxO7Q.png 786w, https://miro.medium.com/max/828/1*L7autVhrmJ5iQcGptOxO7Q.png 828w, https://miro.medium.com/max/1100/1*L7autVhrmJ5iQcGptOxO7Q.png 1100w, https://miro.medium.com/max/644/1*L7autVhrmJ5iQcGptOxO7Q.png 644w"/><img alt="" class="ce lk ll c" height="539" loading="lazy" role="presentation" width="322"/></picture></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 9: A sample data set containing students, essays, and grades. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="fdf6">Those unfamiliar with data leakage might start by creating a 60/40 train/test split as we’ve done in previous examples. You can see in Figure 10 that students one, two, and three are each in the training <strong class="ls jm">and</strong> test sets.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="gl gm oh"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 312px" srcset="https://miro.medium.com/max/640/1*xk2LqdSdetImYAz8a7vNig.png 640w, https://miro.medium.com/max/720/1*xk2LqdSdetImYAz8a7vNig.png 720w, https://miro.medium.com/max/750/1*xk2LqdSdetImYAz8a7vNig.png 750w, https://miro.medium.com/max/786/1*xk2LqdSdetImYAz8a7vNig.png 786w, https://miro.medium.com/max/828/1*xk2LqdSdetImYAz8a7vNig.png 828w, https://miro.medium.com/max/1100/1*xk2LqdSdetImYAz8a7vNig.png 1100w, https://miro.medium.com/max/624/1*xk2LqdSdetImYAz8a7vNig.png 624w"/><img alt="" class="ce lk ll c" height="542" loading="lazy" role="presentation" width="312"/></picture></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 10: A 60/40 random train/test split of our student essay grades dataset. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="b61d">When we split our data this way, our model may unintentionally learn writing behaviors and patterns specific to a specific student. This can cause our model to perform very well on our test set since it has already seen writing from those students, but perform much worse when it sees a new student’s writing.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="6818">Instead of randomly splitting our data, we want each student to be only in the training set or only in the test set. In Figure 11, you can see students one and two are only in the training set, and students three and four are only in the test set.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="gl gm oi"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 310px" srcset="https://miro.medium.com/max/640/1*AAufY50i0SJvGYEzMVq7SA.png 640w, https://miro.medium.com/max/720/1*AAufY50i0SJvGYEzMVq7SA.png 720w, https://miro.medium.com/max/750/1*AAufY50i0SJvGYEzMVq7SA.png 750w, https://miro.medium.com/max/786/1*AAufY50i0SJvGYEzMVq7SA.png 786w, https://miro.medium.com/max/828/1*AAufY50i0SJvGYEzMVq7SA.png 828w, https://miro.medium.com/max/1100/1*AAufY50i0SJvGYEzMVq7SA.png 1100w, https://miro.medium.com/max/620/1*AAufY50i0SJvGYEzMVq7SA.png 620w"/><img alt="" class="ce lk ll c" height="539" loading="lazy" role="presentation" width="310"/></picture></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 11: A train/test split by Student Number. Students 1 and 2 appear only in the training set, while Students 3 and 4 only appear in the test set. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="23b4">The Python library scikit-learn makes this simple to implement with a function called <a class="au lp" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GroupShuffleSplit.html" rel="noopener ugc nofollow" target="_blank">GroupShuffleSplit</a>. In this function, you specify the column to use as your indicator for splitting your data (Student Number for us), and then it takes care of the rest. We highly recommend using this function if your data has some sort of natural grouping.</p><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="31df">Example #4 — Don’t Forget Your Data is a Snapshot</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nt km lv lw nu kp ly lz nv mb mc md nw mf mg mh nx mj mk ml je ga" id="dbb0">Oftentimes in academia, you’re given a dataset that does not change; however, in industry, your dataset is constantly changing. For this next example, let’s say we have a website with a click prediction model that will predict whether or not a user will click on an ad. The output of this model might be used to predict which ads to show users.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm oj"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*HsezSAO2Y3XfoTlAuacJMw.png 640w, https://miro.medium.com/max/720/1*HsezSAO2Y3XfoTlAuacJMw.png 720w, https://miro.medium.com/max/750/1*HsezSAO2Y3XfoTlAuacJMw.png 750w, https://miro.medium.com/max/786/1*HsezSAO2Y3XfoTlAuacJMw.png 786w, https://miro.medium.com/max/828/1*HsezSAO2Y3XfoTlAuacJMw.png 828w, https://miro.medium.com/max/1100/1*HsezSAO2Y3XfoTlAuacJMw.png 1100w, https://miro.medium.com/max/1400/1*HsezSAO2Y3XfoTlAuacJMw.png 1400w"/><img alt="" class="ce lk ll c" height="109" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 12: A snapshot of our data on 5/16/21 and again on 5/31/21. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="a9ca">In Figure 12, we have user one who visits our site for the first time on 5/16/2021. Because this is their first time on our site, they haven’t clicked any ads previously. Let’s say we serve them an ad, and they click on it. A few weeks pass, and when we query our dataset, we notice that user one now has clicked on two ads previously as well as the current ad we’ve shown them.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="93ea">If we include previous ad clicks as a feature in our model, we are leaking future actions for the user into our training set. When we train our model, we know that user one is going to click two ads. This may make more sense if we place our data on a timeline.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm ok"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*L3gtAsNGwku9_-NJ3cCCYg.png 640w, https://miro.medium.com/max/720/1*L3gtAsNGwku9_-NJ3cCCYg.png 720w, https://miro.medium.com/max/750/1*L3gtAsNGwku9_-NJ3cCCYg.png 750w, https://miro.medium.com/max/786/1*L3gtAsNGwku9_-NJ3cCCYg.png 786w, https://miro.medium.com/max/828/1*L3gtAsNGwku9_-NJ3cCCYg.png 828w, https://miro.medium.com/max/1100/1*L3gtAsNGwku9_-NJ3cCCYg.png 1100w, https://miro.medium.com/max/1400/1*L3gtAsNGwku9_-NJ3cCCYg.png 1400w"/><img alt="" class="ce lk ll c" height="212" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 13: A timeline representation of important events related to our ad click data. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="b7e4">When a user visits our site, we show them an ad, and our model predicts whether or not the user will click the ad. The user might click on the ad and then leave the site. Then we can finally calculate the number of ads they clicked on the site. Similar to Example 2, we want to note where our model makes its prediction, and then only include information in the model that happens before that prediction.</p><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="897c">Example 5 — Don’t Randomly Split Data While Retraining</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nt km lv lw nu kp ly lz nv mb mc md nw mf mg mh nx mj mk ml je ga" id="a68b">Up until now, we’ve only discussed data leakage occurring when you <strong class="ls jm">train</strong> your model. If you come from academia, you may have only ever trained a model and not deployed it. In industry, once you’ve trained a model and deployed it to production, you will eventually need to retrain your model because your model sees data much different from what it was trained on. We’ll walk through an example of where data leakage can occur in the retraining process.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="0f2e">For this example shown in Figure 14, let's say we trained a model on 6/15/21 using a 60/40 random train/test split. Our model was trained on data points 1, 2, 4, 5, 6, and 10. It was tested on data points 3, 7, 8, and 9.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm ol"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*2qbCxGOROf3zsThg7X2PBA.png 640w, https://miro.medium.com/max/720/1*2qbCxGOROf3zsThg7X2PBA.png 720w, https://miro.medium.com/max/750/1*2qbCxGOROf3zsThg7X2PBA.png 750w, https://miro.medium.com/max/786/1*2qbCxGOROf3zsThg7X2PBA.png 786w, https://miro.medium.com/max/828/1*2qbCxGOROf3zsThg7X2PBA.png 828w, https://miro.medium.com/max/1100/1*2qbCxGOROf3zsThg7X2PBA.png 1100w, https://miro.medium.com/max/1400/1*2qbCxGOROf3zsThg7X2PBA.png 1400w"/><img alt="" class="ce lk ll c" height="51" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 14: A 60/40 random train/test split for the production model. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="d9c1">After deploying to production, several months pass, and our model performance gradually decreases, so it’s time to retrain. On 8/30/21, we train a new model (challenger) intending to replace the current production model. During the training of our challenger model, we used a 60/40 random train/test split. This included all of the 10 data points the production model was trained on as well as five new data points (11, 12, 13, 14, 15) we collected after the production model was deployed.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="c53a">To compare these models, we want to have our production and challenger models both make predictions on the <strong class="ls jm">challenger model’s test set</strong>. However, when we go to make our predictions, we’ll find that the production model has been trained on data points that are in the challenger model’s test set (1, 2, and 10) which gives the production model an unfair advantage.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm om"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*Ikm8d40tibjHEGwg7NCIkw.png 640w, https://miro.medium.com/max/720/1*Ikm8d40tibjHEGwg7NCIkw.png 720w, https://miro.medium.com/max/750/1*Ikm8d40tibjHEGwg7NCIkw.png 750w, https://miro.medium.com/max/786/1*Ikm8d40tibjHEGwg7NCIkw.png 786w, https://miro.medium.com/max/828/1*Ikm8d40tibjHEGwg7NCIkw.png 828w, https://miro.medium.com/max/1100/1*Ikm8d40tibjHEGwg7NCIkw.png 1100w, https://miro.medium.com/max/1400/1*Ikm8d40tibjHEGwg7NCIkw.png 1400w"/><img alt="" class="ce lk ll c" height="171" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 15: Comparing the training and test sets used for the production model and the challenger model. Three of the data points (1, 2, and 10) in the challenger model’s test set were used to train the production model. This gives the production model an unfair advantage when comparing the two models. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="e1ba">To further illustrate this, let’s look at the results of our production and challenger model predictions on the challenger model’s test set, shown in Figure 16. We know that the production model has already been trained on data points 1, 2, and 10, so you can see below it correctly predicts them. However, the challenger model hasn’t seen those data points before, so it incorrectly predicts them. Data points 3, 8, and 12 have not been seen by either model, so there is a mixture of correct and incorrect predictions.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="gl gm on"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 456px" srcset="https://miro.medium.com/max/640/1*CMHXuILGPvCX9vO4BkFTdQ.png 640w, https://miro.medium.com/max/720/1*CMHXuILGPvCX9vO4BkFTdQ.png 720w, https://miro.medium.com/max/750/1*CMHXuILGPvCX9vO4BkFTdQ.png 750w, https://miro.medium.com/max/786/1*CMHXuILGPvCX9vO4BkFTdQ.png 786w, https://miro.medium.com/max/828/1*CMHXuILGPvCX9vO4BkFTdQ.png 828w, https://miro.medium.com/max/1100/1*CMHXuILGPvCX9vO4BkFTdQ.png 1100w, https://miro.medium.com/max/912/1*CMHXuILGPvCX9vO4BkFTdQ.png 912w"/><img alt="" class="ce lk ll c" height="392" loading="lazy" role="presentation" width="456"/></picture></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 16: The results of the production and challenger model predictions on the challenger model test set. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="9a6d">When we calculate our accuracy, the production model has a score of 67% while the challenger has a score of 33%. Looking at these results, we would likely keep the current production model and try out other challenger models. However, if we look closely, we will see that we’ve introduced data leakage into our production model, and it artificially looks better than the challenger model!</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="946c">To prevent data leakage in this scenario, we must save all of our training and test sets. Let’s say we keep the same random train/test split for the production model. When we go to train our challenger model, we want to load in the training and test sets that we used for the production model and use those same sets for our challenger model. Then we’ll distribute our new data points (11, 12, 13, 14, 15) evenly between the training and test set. This will ensure the production model doesn’t accidentally know more than it should.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm oo"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*c5gd1o7mwObJw1qwo9QA1Q.png 640w, https://miro.medium.com/max/720/1*c5gd1o7mwObJw1qwo9QA1Q.png 720w, https://miro.medium.com/max/750/1*c5gd1o7mwObJw1qwo9QA1Q.png 750w, https://miro.medium.com/max/786/1*c5gd1o7mwObJw1qwo9QA1Q.png 786w, https://miro.medium.com/max/828/1*c5gd1o7mwObJw1qwo9QA1Q.png 828w, https://miro.medium.com/max/1100/1*c5gd1o7mwObJw1qwo9QA1Q.png 1100w, https://miro.medium.com/max/1400/1*c5gd1o7mwObJw1qwo9QA1Q.png 1400w"/><img alt="" class="ce lk ll c" height="225" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 17: To create the challenger model train/test split, we first load the training and test sets used by the production model and equally distribute the new data between the training and test sets. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="545f">To further illustrate this, let’s compare our production and challenger model predictions on the challenger model’s test set. In Figure 128, we have an equal playing field because there are no data points that the production model has already seen.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="gl gm op"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 459px" srcset="https://miro.medium.com/max/640/1*Rly7CqHTjRrUcKUbH_Z_Rw.png 640w, https://miro.medium.com/max/720/1*Rly7CqHTjRrUcKUbH_Z_Rw.png 720w, https://miro.medium.com/max/750/1*Rly7CqHTjRrUcKUbH_Z_Rw.png 750w, https://miro.medium.com/max/786/1*Rly7CqHTjRrUcKUbH_Z_Rw.png 786w, https://miro.medium.com/max/828/1*Rly7CqHTjRrUcKUbH_Z_Rw.png 828w, https://miro.medium.com/max/1100/1*Rly7CqHTjRrUcKUbH_Z_Rw.png 1100w, https://miro.medium.com/max/918/1*Rly7CqHTjRrUcKUbH_Z_Rw.png 918w"/><img alt="" class="ce lk ll c" height="393" loading="lazy" role="presentation" width="459"/></picture></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 18: The results of the production and challenger model predictions on the challenger model test set. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="ae70">Now when we calculate the accuracy of each model, we find that the challenger model outperforms the production model.</p><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="3ed3">Best Practice #1— Split Data Immediately</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nt km lv lw nu kp ly lz nv mb mc md nw mf mg mh nx mj mk ml je ga" id="be21">Now that you’ve seen a few examples of where data leakage might occur, let's walk through a few best practices that you should follow on every machine learning project to protect against data leakage.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="cf5a">For this example, we have the number of views for several YouTube videos. To use the views as a feature in a machine learning model, we would need to normalize our data to adjust for outliers. One way we can do this is through min-max normalization. This takes the minimum and maximum of your dataset and uses them to transform your values between 0 and 1.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="gl gm oq"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 472px" srcset="https://miro.medium.com/max/640/1*l118MzcmbCrU3gQZWiXESA.png 640w, https://miro.medium.com/max/720/1*l118MzcmbCrU3gQZWiXESA.png 720w, https://miro.medium.com/max/750/1*l118MzcmbCrU3gQZWiXESA.png 750w, https://miro.medium.com/max/786/1*l118MzcmbCrU3gQZWiXESA.png 786w, https://miro.medium.com/max/828/1*l118MzcmbCrU3gQZWiXESA.png 828w, https://miro.medium.com/max/1100/1*l118MzcmbCrU3gQZWiXESA.png 1100w, https://miro.medium.com/max/944/1*l118MzcmbCrU3gQZWiXESA.png 944w"/><img alt="" class="ce lk ll c" height="163" loading="lazy" role="presentation" width="472"/></picture></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 19: Min-max normalization formula Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="c7d8">A simple mistake that’s easy to make is to split your data after normalization or other transformations. In Figure 20, we’ve done a 60/40 random train/test split <strong class="ls jm">after</strong> normalizing our data. You’ll notice that the normalized min and max (0 and 1) are split across the training and test sets. To prevent data leakage, both the training and test sets should have a min of 0 and a max of 1.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm or"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*k4PyevqewoUN_cwQkiWzgQ.png 640w, https://miro.medium.com/max/720/1*k4PyevqewoUN_cwQkiWzgQ.png 720w, https://miro.medium.com/max/750/1*k4PyevqewoUN_cwQkiWzgQ.png 750w, https://miro.medium.com/max/786/1*k4PyevqewoUN_cwQkiWzgQ.png 786w, https://miro.medium.com/max/828/1*k4PyevqewoUN_cwQkiWzgQ.png 828w, https://miro.medium.com/max/1100/1*k4PyevqewoUN_cwQkiWzgQ.png 1100w, https://miro.medium.com/max/1400/1*k4PyevqewoUN_cwQkiWzgQ.png 1400w"/><img alt="" class="ce lk ll c" height="387" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 20: The incorrect process of first normalizing your data and then splitting it into training and test sets. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="1c60">What we want to do is split our data first, and then normalize. You can see Figure 21 that the training and test sets each have a minimum of 0 and a maximum of 1.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm os"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*fm6mKvoPkSJZYDsFVE2wAw.png 640w, https://miro.medium.com/max/720/1*fm6mKvoPkSJZYDsFVE2wAw.png 720w, https://miro.medium.com/max/750/1*fm6mKvoPkSJZYDsFVE2wAw.png 750w, https://miro.medium.com/max/786/1*fm6mKvoPkSJZYDsFVE2wAw.png 786w, https://miro.medium.com/max/828/1*fm6mKvoPkSJZYDsFVE2wAw.png 828w, https://miro.medium.com/max/1100/1*fm6mKvoPkSJZYDsFVE2wAw.png 1100w, https://miro.medium.com/max/1400/1*fm6mKvoPkSJZYDsFVE2wAw.png 1400w"/><img alt="" class="ce lk ll c" height="423" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 21: The correct process of first splitting your data and then normalizing it. Image by author.</figcaption></figure><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="a3bc">Best Practice #2 — Use Cross-Validation</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nt km lv lw nu kp ly lz nv mb mc md nw mf mg mh nx mj mk ml je ga" id="1538">Throughout this article, we’ve split our data into two sets: train and test. Here we will introduce a third set called validation that helps prevent data leakage.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="508e">We begin by splitting our dataset into train and test sets. Next, we take our training set and split it into k-folds. For this example, let k=3. This will split our training set into three different parts (folds). Two of these parts will be used for training, and one part will be used for validation. We repeat this process by shuffling which parts are used for training and validation. Throughout this process, we find the best parameters for our model and then evaluate them on our original test set, which contains data the model hasn’t seen before.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm ot"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*0Xo2GlwIOmu7VEt7GAK88w.png 640w, https://miro.medium.com/max/720/1*0Xo2GlwIOmu7VEt7GAK88w.png 720w, https://miro.medium.com/max/750/1*0Xo2GlwIOmu7VEt7GAK88w.png 750w, https://miro.medium.com/max/786/1*0Xo2GlwIOmu7VEt7GAK88w.png 786w, https://miro.medium.com/max/828/1*0Xo2GlwIOmu7VEt7GAK88w.png 828w, https://miro.medium.com/max/1100/1*0Xo2GlwIOmu7VEt7GAK88w.png 1100w, https://miro.medium.com/max/1400/1*0Xo2GlwIOmu7VEt7GAK88w.png 1400w"/><img alt="" class="ce lk ll c" height="424" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 22: An example of 3-fold cross-validation. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="8765">While this process may seem complicated at first, scikit-learn has a simple implementation that you can call in one line of code. We highly recommend using cross-validation to prevent data leakage.</p><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="e104">Best Practice #3 — Be Skeptical of High Performance</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nt km lv lw nu kp ly lz nv mb mc md nw mf mg mh nx mj mk ml je ga" id="0734">Nothing feels better than when your model reaches 99% precision, recall, or any other metric. Unfortunately, if it sounds too good to be true, it probably is. There’s a good chance your model might have data leakage and won’t be able to produce the same results on unseen data.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="71e1">There are two different scenarios where high model performance might be a sign of data leakage. The first one is when your training and test sets perform well, but your validation set performs better than either set. If you see this in your results, you may want to think critically about your project setup and analyze it for data leakage.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm ou"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*A2Pg0td9Td7UzXZDIatFRw.png 640w, https://miro.medium.com/max/720/1*A2Pg0td9Td7UzXZDIatFRw.png 720w, https://miro.medium.com/max/750/1*A2Pg0td9Td7UzXZDIatFRw.png 750w, https://miro.medium.com/max/786/1*A2Pg0td9Td7UzXZDIatFRw.png 786w, https://miro.medium.com/max/828/1*A2Pg0td9Td7UzXZDIatFRw.png 828w, https://miro.medium.com/max/1100/1*A2Pg0td9Td7UzXZDIatFRw.png 1100w, https://miro.medium.com/max/1400/1*A2Pg0td9Td7UzXZDIatFRw.png 1400w"/><img alt="" class="ce lk ll c" height="147" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 23: An example of a validation set performing better than both the train and test sets. F1 score is the harmonic mean of precision and recall. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="49ef">The second scenario that might be an indicator of data leakage is when your training, test, and validation sets <strong class="ls jm">all</strong> perform exceptionally well. In Figure 24, all three sets have scores of 99%. Your first instinct might be to celebrate, but you should probably review your project for data leakage before deploying to production.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm ov"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*_MzFfo9iL6-epQENp7X4FA.png 640w, https://miro.medium.com/max/720/1*_MzFfo9iL6-epQENp7X4FA.png 720w, https://miro.medium.com/max/750/1*_MzFfo9iL6-epQENp7X4FA.png 750w, https://miro.medium.com/max/786/1*_MzFfo9iL6-epQENp7X4FA.png 786w, https://miro.medium.com/max/828/1*_MzFfo9iL6-epQENp7X4FA.png 828w, https://miro.medium.com/max/1100/1*_MzFfo9iL6-epQENp7X4FA.png 1100w, https://miro.medium.com/max/1400/1*_MzFfo9iL6-epQENp7X4FA.png 1400w"/><img alt="" class="ce lk ll c" height="148" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 24: An example of high performance in the train, test, and validation sets. Image by author.</figcaption></figure><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="3bd6">Best Practice #4 — Use scikit-learn Pipelines</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nt km lv lw nu kp ly lz nv mb mc md nw mf mg mh nx mj mk ml je ga" id="ce75">We’ve mentioned scikit-learn several times throughout this article for a reason — the library has a ton of great functionality for machine learning projects! One tool we recommend using from the library is called a pipeline. Pipelines are great at preventing data leakage because they apply a set of steps in a certain order and cross-validate them together.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="9ad5">The below example illustrating pipeline usage is from <a class="au lp" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html" rel="noopener ugc nofollow" target="_blank">scikit-learn’s documentation</a>. They first split their data into a train and test set and then create a pipeline that scales their data and applies a support vector classifier to make predictions.</p><pre class="lb lc ld le gx ow bs ox oy dz oz"><span class="ga pa nc jl oz b dm pb pc l pd pe" id="0cf6"><strong class="oz jm">from</strong> <strong class="oz jm">sklearn.svm</strong> <strong class="oz jm">import</strong> SVC<br/><strong class="oz jm">from</strong> <strong class="oz jm">sklearn.preprocessing</strong> <strong class="oz jm">import</strong> StandardScaler<br/><strong class="oz jm">from</strong> <strong class="oz jm">sklearn.datasets</strong> <strong class="oz jm">import</strong> make_classification<br/><strong class="oz jm">from</strong> <strong class="oz jm">sklearn.model_selection</strong> <strong class="oz jm">import</strong> train_test_split<br/><strong class="oz jm">from</strong> <strong class="oz jm">sklearn.pipeline</strong> <strong class="oz jm">import</strong> Pipeline</span><span class="ga pa nc jl oz b dm pf pc l pd pe" id="0838">X, y = make_classification(random_state=0)<br/>X_train, X_test, y_train, y_test = train_test_split(X, y,<br/>                                                 random_state=0)</span><span class="ga pa nc jl oz b dm pf pc l pd pe" id="b42e">pipe = Pipeline([('scaler', StandardScaler()), ('svc', SVC())])<br/>pipe.fit(X_train, y_train)<br/>pipe.score(X_test, y_test)</span></pre><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="473c">Best Practice #5 — Check For Features Correlated with the Target</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nt km lv lw nu kp ly lz nv mb mc md nw mf mg mh nx mj mk ml je ga" id="8120">Our last best practice is to check if any of your features are correlated with the variables you are trying to predict (target). In Figure 25, we have some health care data, and we want to predict whether or not someone will get the flu. We might decide to include the “Took Antibiotics” column as an input into our model.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="gl gm pg"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 623px" srcset="https://miro.medium.com/max/640/1*YQwiCBxVneNd31WGp97D7A.png 640w, https://miro.medium.com/max/720/1*YQwiCBxVneNd31WGp97D7A.png 720w, https://miro.medium.com/max/750/1*YQwiCBxVneNd31WGp97D7A.png 750w, https://miro.medium.com/max/786/1*YQwiCBxVneNd31WGp97D7A.png 786w, https://miro.medium.com/max/828/1*YQwiCBxVneNd31WGp97D7A.png 828w, https://miro.medium.com/max/1100/1*YQwiCBxVneNd31WGp97D7A.png 1100w, https://miro.medium.com/max/1246/1*YQwiCBxVneNd31WGp97D7A.png 1246w"/><img alt="" class="ce lk ll c" height="236" loading="lazy" role="presentation" width="623"/></picture></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 25: Sample health care data. Image by author.</figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="19bf">However, we should probably think twice when we see that that variable is highly correlated with the variable we’re trying to predict (“Got the Flu”). This may be a sign of data leakage.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="b48d">Another way to think about this is by instead placing our data on a timeline as we learned earlier. You’ll notice that once we do this, we realize that you won’t take antibiotics until <strong class="ls jm">after</strong> you get the flu. If we included “Took Antibiotics” in our model, we would be leaking data from the future into our model.</p><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="5b46">Recap</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nt km lv lw nu kp ly lz nv mb mc md nw mf mg mh nx mj mk ml je ga" id="0907">In summary, data leakage occurs when your model knows too much information, and it can be extremely difficult to spot. We’ve covered a few different methods identifying and preventing data leakage, as well as some best practices for machine learning projects.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="8e69">If you liked this article, we also teach data science courses on Skillshare. You can check out our course on data leakage and get a free trial of Skillshare using our referral link <a class="au lp" href="https://skl.sh/3rEoZgW" rel="noopener ugc nofollow" target="_blank">here</a>.</p><h1 class="nb nc jl bm nd ne nf ng nh ni nj nk nl kr nm ks nn ku no kv np kx nq ky nr ns ga" id="ca41">References</h1><ol class=""><li class="mm mn jl ls b lt nt lw nu lz ph md pi mh pj ml ny ms mt mu ga" id="bafc"><a class="au lp" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html" rel="noopener ugc nofollow" target="_blank">https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html</a></li><li class="mm mn jl ls b lt mw lw mx lz my md mz mh na ml ny ms mt mu ga" id="fcdd">E. Ameisen, Building Machine Learning Powered Applications (2020), <a class="au lp" href="https://www.oreilly.com/library/view/building-machine-learning/9781492045106/" rel="noopener ugc nofollow" target="_blank">https://www.oreilly.com/library/view/building-machine-learning/9781492045106/</a></li><li class="mm mn jl ls b lt mw lw mx lz my md mz mh na ml ny ms mt mu ga" id="927d"><a class="au lp" href="https://www.skillshare.com/classes/Data-Science-Mistakes-to-Avoid-Data-Leakage/1955732280" rel="noopener ugc nofollow" target="_blank">https://www.skillshare.com/classes/Data-Science-Mistakes-to-Avoid-Data-Leakage/1955732280</a></li></ol></div></div></section></div></div></article>