<article class="meteredContent"><div class="l"><div class="gg gh gi gj gk gl gm ce gn ch l"></div><div class="l"><header class="pw-post-byline-header go gp gq gr gs gt gu gv gw gx l"><div class="o gy u"><div class="o"><div class="fj l"><a class="au av aw ax ay az ba bb bc bd be bf bg bh bi" href="https://sophiamyang.medium.com/?source=post_page-----9cc43ad530d6--------------------------------" rel="noopener follow"><div class="l do"><img alt="Sophia Yang" class="l ch fl gz ha fp" height="48" loading="lazy" src="https://miro.medium.com/fit/c/96/96/1*Byc_L6tFFHodsAwB4LJ0eA.jpeg" width="48"/><div class="fk fl l gz ha fo aq"></div></div></a></div><div class="l"><div class="pw-author bm b dm dn ga"><div class="hb o hc"><div><div aria-hidden="false" class="ci"><a class="au av aw ax ay az ba bb bc bd be bf bg bh bi" href="https://sophiamyang.medium.com/?source=post_page-----9cc43ad530d6--------------------------------" rel="noopener follow">Sophia Yang</a></div></div><div class="hd he hf hg hh d"><span><a class="bm b hi bo hj hk hl hm hn ho hp bd bz hq hr hs cd cf cg ch ci cj" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fae9cae9cbcd2&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-drift-9cc43ad530d6&amp;user=Sophia+Yang&amp;userId=ae9cae9cbcd2&amp;source=post_page-ae9cae9cbcd2----9cc43ad530d6---------------------follow_byline-----------" rel="noopener follow">Follow</a></span></div></div></div><div class="o ao ht"><p class="pw-published-date bm b bn bo cn"><span>Aug 24</span></p><div aria-hidden="true" class="hu ci"><span aria-hidden="true" class="l"><span class="bm b bn bo cn">·</span></span></div><div class="pw-reading-time bm b bn bo cn">7 min read</div><div aria-hidden="true" class="hu ci"><span aria-hidden="true" class="l"><span class="bm b bn bo cn">·</span></span></div><div class="hx l"><div aria-hidden="false" class="l"><button class="l dz hv bb"><div class="j i d"><div><div aria-hidden="false" class="ci"><svg fill="none" height="20" viewbox="0 0 20 20" width="20"><path d="M12.4 12.77l-1.81 4.99a.63.63 0 0 1-1.18 0l-1.8-4.99a.63.63 0 0 0-.38-.37l-4.99-1.81a.62.62 0 0 1 0-1.18l4.99-1.8a.63.63 0 0 0 .37-.38l1.81-4.99a.63.63 0 0 1 1.18 0l1.8 4.99a.63.63 0 0 0 .38.37l4.99 1.81a.63.63 0 0 1 0 1.18l-4.99 1.8a.63.63 0 0 0-.37.38z" fill="#FFC017"></path></svg></div></div></div><div class="h k hy hz ia"><svg class="hw" fill="none" height="20" viewbox="0 0 20 20" width="20"><path d="M12.4 12.77l-1.81 4.99a.63.63 0 0 1-1.18 0l-1.8-4.99a.63.63 0 0 0-.38-.37l-4.99-1.81a.62.62 0 0 1 0-1.18l4.99-1.8a.63.63 0 0 0 .37-.38l1.81-4.99a.63.63 0 0 1 1.18 0l1.8 4.99a.63.63 0 0 0 .38.37l4.99 1.81a.63.63 0 0 1 0 1.18l-4.99 1.8a.63.63 0 0 0-.37.38z" fill="#FFC017"></path></svg><p class="bm b bn bo cn">Member-only</p></div></button></div></div></div></div></div><div class="o ao"><div class="h k ib ic id"><div class="ie l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on twitter" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M20 5.34c-.67.41-1.4.7-2.18.87a3.45 3.45 0 0 0-5.02-.1 3.49 3.49 0 0 0-1.02 2.47c0 .28.03.54.07.8a9.91 9.91 0 0 1-7.17-3.66 3.9 3.9 0 0 0-.5 1.74 3.6 3.6 0 0 0 1.56 2.92 3.36 3.36 0 0 1-1.55-.44V10c0 1.67 1.2 3.08 2.8 3.42-.3.06-.6.1-.94.12l-.62-.06a3.5 3.5 0 0 0 3.24 2.43 7.34 7.34 0 0 1-4.36 1.49l-.81-.05a9.96 9.96 0 0 0 5.36 1.56c6.4 0 9.91-5.32 9.9-9.9v-.5c.69-.49 1.28-1.1 1.74-1.81-.63.3-1.3.48-2 .56A3.33 3.33 0 0 0 20 5.33" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="ie l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on facebook" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M19.75 12.04c0-4.3-3.47-7.79-7.75-7.79a7.77 7.77 0 0 0-5.9 12.84 7.77 7.77 0 0 0 4.69 2.63v-5.49h-1.9v-2.2h1.9v-1.62c0-1.88 1.14-2.9 2.8-2.9.8 0 1.49.06 1.69.08v1.97h-1.15c-.91 0-1.1.43-1.1 1.07v1.4h2.17l-.28 2.2h-1.88v5.52a7.77 7.77 0 0 0 6.7-7.71" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="ie l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on linkedin" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M19.75 5.39v13.22a1.14 1.14 0 0 1-1.14 1.14H5.39a1.14 1.14 0 0 1-1.14-1.14V5.39a1.14 1.14 0 0 1 1.14-1.14h13.22a1.14 1.14 0 0 1 1.14 1.14zM8.81 10.18H6.53v7.3H8.8v-7.3zM9 7.67a1.31 1.31 0 0 0-1.3-1.32h-.04a1.32 1.32 0 0 0 0 2.64A1.31 1.31 0 0 0 9 7.71v-.04zm8.46 5.37c0-2.2-1.4-3.05-2.78-3.05a2.6 2.6 0 0 0-2.3 1.18h-.07v-1h-2.14v7.3h2.28V13.6a1.51 1.51 0 0 1 1.36-1.63h.09c.72 0 1.26.45 1.26 1.6v3.91h2.28l.02-4.43z" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="l fr"><div><div aria-hidden="false" class="ci"><button class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path clip-rule="evenodd" d="M3.57 14.67c0-.57.13-1.11.38-1.6l.02-.02v-.02l.02-.02c0-.02 0-.02.02-.02.12-.26.3-.52.57-.8L7.78 9v-.02l.01-.02c.44-.41.91-.7 1.44-.85a4.87 4.87 0 0 0-1.19 2.36A5.04 5.04 0 0 0 8 11.6L6.04 13.6c-.19.19-.32.4-.38.65a2 2 0 0 0 0 .9c.08.2.2.4.38.57l1.29 1.31c.27.28.62.42 1.03.42.42 0 .78-.14 1.06-.42l1.23-1.25.79-.78 1.15-1.16c.08-.09.19-.22.28-.4.1-.2.15-.42.15-.67 0-.16-.02-.3-.06-.45l-.02-.02v-.02l-.07-.14s0-.03-.04-.06l-.06-.13-.02-.02c0-.02 0-.03-.02-.05a.6.6 0 0 0-.14-.16l-.48-.5c0-.04.02-.1.04-.15l.06-.12 1.17-1.14.09-.09.56.57c.02.04.08.1.16.18l.05.04.03.06.04.05.03.04.04.06.1.14.02.02c0 .02.01.03.03.04l.1.2v.02c.1.16.2.38.3.68a1 1 0 0 1 .04.25 3.2 3.2 0 0 1 .02 1.33 3.49 3.49 0 0 1-.95 1.87l-.66.67-.97.97-1.56 1.57a3.4 3.4 0 0 1-2.47 1.02c-.97 0-1.8-.34-2.49-1.03l-1.3-1.3a3.55 3.55 0 0 1-1-2.51v-.01h-.02v.02zm5.39-3.43c0-.19.02-.4.07-.63.13-.74.44-1.37.95-1.87l.66-.67.97-.98 1.56-1.56c.68-.69 1.5-1.03 2.47-1.03.97 0 1.8.34 2.48 1.02l1.3 1.32a3.48 3.48 0 0 1 1 2.48c0 .58-.11 1.11-.37 1.6l-.02.02v.02l-.02.04c-.14.27-.35.54-.6.8L16.23 15l-.01.02-.01.02c-.44.42-.92.7-1.43.83a4.55 4.55 0 0 0 1.23-3.52L18 10.38c.18-.21.3-.42.35-.65a2.03 2.03 0 0 0-.01-.9 1.96 1.96 0 0 0-.36-.58l-1.3-1.3a1.49 1.49 0 0 0-1.06-.42c-.42 0-.77.14-1.06.4l-1.2 1.27-.8.8-1.16 1.15c-.08.08-.18.21-.29.4a1.66 1.66 0 0 0-.08 1.12l.02.03v.02l.06.14s.01.03.05.06l.06.13.02.02.01.02.01.02c.05.08.1.13.14.16l.47.5c0 .04-.02.09-.04.15l-.06.12-1.15 1.15-.1.08-.56-.56a2.3 2.3 0 0 0-.18-.19c-.02-.01-.02-.03-.02-.04l-.02-.02a.37.37 0 0 1-.1-.12c-.03-.03-.05-.04-.05-.06l-.1-.15-.02-.02-.02-.04-.08-.17v-.02a5.1 5.1 0 0 1-.28-.69 1.03 1.03 0 0 1-.04-.26c-.06-.23-.1-.46-.1-.7v.01z" fill="#A8A8A8" fill-rule="evenodd"></path></svg></span></button></div></div></div><div class="ih o ao"><span><a class="au av aw ax ay az ba bb bc bd be bf bg bh bi" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9cc43ad530d6&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-drift-9cc43ad530d6&amp;source=--------------------------bookmark_header-----------" rel="noopener follow"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" class="au de aw ax ay az ba if bc hv ij ik il"><svg aria-label="Add to list bookmark button" class="ii" fill="none" height="25" viewbox="0 0 25 25" width="25"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="#292929"></path></svg></button></a></span></div></div><div class="ck im"><div><div aria-hidden="false" class="ci"></div></div></div></div></div><div class="in io ip j i d"><div class="fj l"><span><a class="au av aw ax ay az ba bb bc bd be bf bg bh bi" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9cc43ad530d6&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-drift-9cc43ad530d6&amp;source=--------------------------bookmark_header-----------" rel="noopener follow"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" class="au de aw iq ay az ba ir bc hv cd o ao is it il"><svg aria-label="Add to list bookmark button" class="ii" fill="none" height="25" viewbox="0 0 25 25" width="25"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="#292929"></path></svg><p class="bm b bn bo cn">Save</p></button></a></span></div><div class="iu l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on twitter" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M20 5.34c-.67.41-1.4.7-2.18.87a3.45 3.45 0 0 0-5.02-.1 3.49 3.49 0 0 0-1.02 2.47c0 .28.03.54.07.8a9.91 9.91 0 0 1-7.17-3.66 3.9 3.9 0 0 0-.5 1.74 3.6 3.6 0 0 0 1.56 2.92 3.36 3.36 0 0 1-1.55-.44V10c0 1.67 1.2 3.08 2.8 3.42-.3.06-.6.1-.94.12l-.62-.06a3.5 3.5 0 0 0 3.24 2.43 7.34 7.34 0 0 1-4.36 1.49l-.81-.05a9.96 9.96 0 0 0 5.36 1.56c6.4 0 9.91-5.32 9.9-9.9v-.5c.69-.49 1.28-1.1 1.74-1.81-.63.3-1.3.48-2 .56A3.33 3.33 0 0 0 20 5.33" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="iu l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on facebook" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M19.75 12.04c0-4.3-3.47-7.79-7.75-7.79a7.77 7.77 0 0 0-5.9 12.84 7.77 7.77 0 0 0 4.69 2.63v-5.49h-1.9v-2.2h1.9v-1.62c0-1.88 1.14-2.9 2.8-2.9.8 0 1.49.06 1.69.08v1.97h-1.15c-.91 0-1.1.43-1.1 1.07v1.4h2.17l-.28 2.2h-1.88v5.52a7.77 7.77 0 0 0 6.7-7.71" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="iu l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on linkedin" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M19.75 5.39v13.22a1.14 1.14 0 0 1-1.14 1.14H5.39a1.14 1.14 0 0 1-1.14-1.14V5.39a1.14 1.14 0 0 1 1.14-1.14h13.22a1.14 1.14 0 0 1 1.14 1.14zM8.81 10.18H6.53v7.3H8.8v-7.3zM9 7.67a1.31 1.31 0 0 0-1.3-1.32h-.04a1.32 1.32 0 0 0 0 2.64A1.31 1.31 0 0 0 9 7.71v-.04zm8.46 5.37c0-2.2-1.4-3.05-2.78-3.05a2.6 2.6 0 0 0-2.3 1.18h-.07v-1h-2.14v7.3h2.28V13.6a1.51 1.51 0 0 1 1.36-1.63h.09c.72 0 1.26.45 1.26 1.6v3.91h2.28l.02-4.43z" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="l fr"><div><div aria-hidden="false" class="ci"><button class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path clip-rule="evenodd" d="M3.57 14.67c0-.57.13-1.11.38-1.6l.02-.02v-.02l.02-.02c0-.02 0-.02.02-.02.12-.26.3-.52.57-.8L7.78 9v-.02l.01-.02c.44-.41.91-.7 1.44-.85a4.87 4.87 0 0 0-1.19 2.36A5.04 5.04 0 0 0 8 11.6L6.04 13.6c-.19.19-.32.4-.38.65a2 2 0 0 0 0 .9c.08.2.2.4.38.57l1.29 1.31c.27.28.62.42 1.03.42.42 0 .78-.14 1.06-.42l1.23-1.25.79-.78 1.15-1.16c.08-.09.19-.22.28-.4.1-.2.15-.42.15-.67 0-.16-.02-.3-.06-.45l-.02-.02v-.02l-.07-.14s0-.03-.04-.06l-.06-.13-.02-.02c0-.02 0-.03-.02-.05a.6.6 0 0 0-.14-.16l-.48-.5c0-.04.02-.1.04-.15l.06-.12 1.17-1.14.09-.09.56.57c.02.04.08.1.16.18l.05.04.03.06.04.05.03.04.04.06.1.14.02.02c0 .02.01.03.03.04l.1.2v.02c.1.16.2.38.3.68a1 1 0 0 1 .04.25 3.2 3.2 0 0 1 .02 1.33 3.49 3.49 0 0 1-.95 1.87l-.66.67-.97.97-1.56 1.57a3.4 3.4 0 0 1-2.47 1.02c-.97 0-1.8-.34-2.49-1.03l-1.3-1.3a3.55 3.55 0 0 1-1-2.51v-.01h-.02v.02zm5.39-3.43c0-.19.02-.4.07-.63.13-.74.44-1.37.95-1.87l.66-.67.97-.98 1.56-1.56c.68-.69 1.5-1.03 2.47-1.03.97 0 1.8.34 2.48 1.02l1.3 1.32a3.48 3.48 0 0 1 1 2.48c0 .58-.11 1.11-.37 1.6l-.02.02v.02l-.02.04c-.14.27-.35.54-.6.8L16.23 15l-.01.02-.01.02c-.44.42-.92.7-1.43.83a4.55 4.55 0 0 0 1.23-3.52L18 10.38c.18-.21.3-.42.35-.65a2.03 2.03 0 0 0-.01-.9 1.96 1.96 0 0 0-.36-.58l-1.3-1.3a1.49 1.49 0 0 0-1.06-.42c-.42 0-.77.14-1.06.4l-1.2 1.27-.8.8-1.16 1.15c-.08.08-.18.21-.29.4a1.66 1.66 0 0 0-.08 1.12l.02.03v.02l.06.14s.01.03.05.06l.06.13.02.02.01.02.01.02c.05.08.1.13.14.16l.47.5c0 .04-.02.09-.04.15l-.06.12-1.15 1.15-.1.08-.56-.56a2.3 2.3 0 0 0-.18-.19c-.02-.01-.02-.03-.02-.04l-.02-.02a.37.37 0 0 1-.1-.12c-.03-.03-.05-.04-.05-.06l-.1-.15-.02-.02-.02-.04-.08-.17v-.02a5.1 5.1 0 0 1-.28-.69 1.03 1.03 0 0 1-.04-.26c-.06-.23-.1-.46-.1-.7v.01z" fill="#A8A8A8" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></header><span class="l"></span><section><div><div class="fo as ja jb jc jd"></div><div class="je jf jg jh ji"><div class=""><h1 class="pw-post-title jj jk jl bm jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ga" id="cc16">Machine Learning Model Drift</h1></div><div class=""><h2 class="pw-subtitle-paragraph ki jk jl bm b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz cn" id="fb4e">Types, causes, detections, mitigations, and tools</h2></div><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm la"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*z3PQedWNHJd6uiXHF9tbSA.jpeg 640w, https://miro.medium.com/max/720/1*z3PQedWNHJd6uiXHF9tbSA.jpeg 720w, https://miro.medium.com/max/750/1*z3PQedWNHJd6uiXHF9tbSA.jpeg 750w, https://miro.medium.com/max/786/1*z3PQedWNHJd6uiXHF9tbSA.jpeg 786w, https://miro.medium.com/max/828/1*z3PQedWNHJd6uiXHF9tbSA.jpeg 828w, https://miro.medium.com/max/1100/1*z3PQedWNHJd6uiXHF9tbSA.jpeg 1100w, https://miro.medium.com/max/1400/1*z3PQedWNHJd6uiXHF9tbSA.jpeg 1400w"/><img alt="" class="ce lk ll c" height="467" loading="eager" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Photo by <a class="au lp" href="https://unsplash.com/@robinpierre?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Robin Pierre</a> on <a class="au lp" href="https://unsplash.com/s/photos/motion?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="b884">In machine learning, model drift means that the machine learning model becomes less and less accurate due to the changes in the statistical properties of the input features, target variable, or relationships among variables. The data on which the machine learning model is trained is called training data or source data. The data on which the model is trying to predict is called serving data or target data. The training/source data distributions might be different from the serving/target data distributions. In this article, we are going to walk through the types of model drift, causes of model drift, how to detect model drift, how to mitigate model drift, and finally the tools we can use to monitor model drift.</p><h1 class="mm mn jl bm mo mp mq mr ms mt mu mv mw kr mx ks my ku mz kv na kx nb ky nc nd ga" id="28ae">Setting</h1><p class="pw-post-body-paragraph lq lr jl ls b lt ne km lv lw nf kp ly lz ng mb mc md nh mf mg mh ni mj mk ml je ga" id="f942">We are predicting a target variable y given a set of input features X. For example, in a house price prediction model, X could be a set of features of houses (e.g., number of bedrooms, size, location), and y could be the house price. One pair of (X, y) indicates one house record in the dataset. p(X) and p(y) are the probabilities of observing house features X and house price y respectively, also known as the marginal probability or prior probability. p(y|X) is the conditional distribution of house prices given house features.</p><h1 class="mm mn jl bm mo mp mq mr ms mt mu mv mw kr mx ks my ku mz kv na kx nb ky nc nd ga" id="83a7">Types of model drift</h1><p class="pw-post-body-paragraph lq lr jl ls b lt ne km lv lw nf kp ly lz ng mb mc md nh mf mg mh ni mj mk ml je ga" id="12b2">Model drift contains two key categories: concept drift and data drift. Data drift further includes covariates/feature drift and label drift.</p><h2 class="nj mn jl bm mo nk nl nm ms nn no np mw lz nq nr my md ns nt na mh nu nv nc nw ga" id="2aae">Covariate/feature drift</h2><p class="pw-post-body-paragraph lq lr jl ls b lt ne km lv lw nf kp ly lz ng mb mc md nh mf mg mh ni mj mk ml je ga" id="c26b">Covariate drift or feature drift happens when p(X) changes but p(y|x) remains the same. The marginal distribution of the input house features changes, but the conditional distribution of house prices given house features stays the same.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="c2d9">Let’s take one house feature — size. Imagine that your model was trained before Covid and at the time, there are more larger-size houses in the market. And during Covid, people all want to move to a larger house and there are fewer and fewer larger-size houses in the market.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm nx"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/0*ZuZDr_pLx9QNZENH 640w, https://miro.medium.com/max/720/0*ZuZDr_pLx9QNZENH 720w, https://miro.medium.com/max/750/0*ZuZDr_pLx9QNZENH 750w, https://miro.medium.com/max/786/0*ZuZDr_pLx9QNZENH 786w, https://miro.medium.com/max/828/0*ZuZDr_pLx9QNZENH 828w, https://miro.medium.com/max/1100/0*ZuZDr_pLx9QNZENH 1100w, https://miro.medium.com/max/1400/0*ZuZDr_pLx9QNZENH 1400w"/><img alt="" class="ce lk ll c" height="287" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 1. Covariate drift (image made by author)</figcaption></figure><h2 class="nj mn jl bm mo nk nl nm ms nn no np mw lz nq nr my md ns nt na mh nu nv nc nw ga" id="6d48">Label drift</h2><p class="pw-post-body-paragraph lq lr jl ls b lt ne km lv lw nf kp ly lz ng mb mc md nh mf mg mh ni mj mk ml je ga" id="0cdd">Label drift happens when p(y) changes but p(x|y) remains the same.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="c67b">In the house price prediction example, the house price distribution p(y) could change after when the model was trained previously. For example, the house price has significantly increased during the pandemic, resulting in the house price distribution shifting towards a higher value.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm nx"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/0*EH-P2eYwAKfubDgx 640w, https://miro.medium.com/max/720/0*EH-P2eYwAKfubDgx 720w, https://miro.medium.com/max/750/0*EH-P2eYwAKfubDgx 750w, https://miro.medium.com/max/786/0*EH-P2eYwAKfubDgx 786w, https://miro.medium.com/max/828/0*EH-P2eYwAKfubDgx 828w, https://miro.medium.com/max/1100/0*EH-P2eYwAKfubDgx 1100w, https://miro.medium.com/max/1400/0*EH-P2eYwAKfubDgx 1400w"/><img alt="" class="ce lk ll c" height="297" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 2. Label drift (image made by author)</figcaption></figure><h2 class="nj mn jl bm mo nk nl nm ms nn no np mw lz nq nr my md ns nt na mh nu nv nc nw ga" id="1549">Concept drift</h2><p class="pw-post-body-paragraph lq lr jl ls b lt ne km lv lw nf kp ly lz ng mb mc md nh mf mg mh ni mj mk ml je ga" id="4bc1">Concept drift happens when p(y|X) changes but p(X) remains the same.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="5d8b">In the house price prediction example, the conditional probability of housing price given house features p(y|X) could change. Let’s reconsider the previous example. Imagine that the distribution of the house sizes does not change. Because people prefer larger houses now, larger houses become more expensive. The conditional probability of housing price given house sizes could change, especially for larger houses.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm nx"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/0*QAgwEGhDhbapZJKm 640w, https://miro.medium.com/max/720/0*QAgwEGhDhbapZJKm 720w, https://miro.medium.com/max/750/0*QAgwEGhDhbapZJKm 750w, https://miro.medium.com/max/786/0*QAgwEGhDhbapZJKm 786w, https://miro.medium.com/max/828/0*QAgwEGhDhbapZJKm 828w, https://miro.medium.com/max/1100/0*QAgwEGhDhbapZJKm 1100w, https://miro.medium.com/max/1400/0*QAgwEGhDhbapZJKm 1400w"/><img alt="" class="ce lk ll c" height="290" loading="lazy" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Figure 3. Concept drift (image made by author)</figcaption></figure><h1 class="mm mn jl bm mo mp mq mr ms mt mu mv mw kr mx ks my ku mz kv na kx nb ky nc nd ga" id="e627">Causes of model drift</h1><p class="pw-post-body-paragraph lq lr jl ls b lt ne km lv lw nf kp ly lz ng mb mc md nh mf mg mh ni mj mk ml je ga" id="233e">There could be lots of causes for ML model drift. Here are a few:</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="b65d">One of the main causes of data drift is <strong class="ls jm">sampling mismatch</strong>. We often use some sampling strategies to find the source data to train our model. The sampling strategy could be <strong class="ls jm">biased and not representative</strong> of the entire population. For example, if we would like to develop a model to predict the housing price for the general Boston area, we can’t use the training data that only include houses listed around the Back Bay area.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="1fd9">Sometimes people apply their well-trained model to <strong class="ls jm">a new product/market/context</strong> and find their model does not work well. For example, the pandemic changes the macro economy of the world. We are in a very different market and context compared to before the pandemic times. This is when the distribution of the features, labels, and the joint distribution of the features and labels can all change. The best solution is to retrain the models.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="d108"><strong class="ls jm">Anomalies</strong> can appear both in the training data and also in the target data. Anomalies can change the distributions of our data. Sometimes our models handle anomalies automatically. Other times, we need to employ some anomaly detection techniques and filter out (e.g., winsorize) the anomalies.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="ac07"><strong class="ls jm">Seasonal effects</strong> can also lead to a model drift. The relationship between multiple variables, for example, house size and house price, might change depending on the month or the season. It’s often recommended to take into account seasonal effects in the model or in some cases, model different scenarios in different models.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="fb11"><strong class="ls jm">Data quality</strong> issues can happen more than you would expect. There are a variety of data quality issues such as incorrect input data, incorrect data processing steps, and duplications. Sometimes the changes in data or data processing pipelines are not quality concerns but are expected and a business requirement. Such data change can also contribute to model drift if not monitored closely. Setting up guardrails to validate data and ensure data quality and consistency is a prerequisite for your ML models.</p><h1 class="mm mn jl bm mo mp mq mr ms mt mu mv mw kr mx ks my ku mz kv na kx nb ky nc nd ga" id="1e66">Detecting drift</h1><h2 class="nj mn jl bm mo nk nl nm ms nn no np mw lz nq nr my md ns nt na mh nu nv nc nw ga" id="729a">Monitor model performance</h2><p class="pw-post-body-paragraph lq lr jl ls b lt ne km lv lw nf kp ly lz ng mb mc md nh mf mg mh ni mj mk ml je ga" id="6457">The most straightforward approach to detecting drift is through monitoring model performance metrics. The most common model performance metrics include confusion matrix, accuracy, recall, F1 score, and ROC-AUC. Depending on your model usage, there might be other model behavior measure metrics that are important as well.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="dbfa">Along the same line, some research focuses on the error rate and uses the error rate-based drift detection method. For example, the Drift Detection Method (DDM) algorithm can be used to detect any significant increase in error rates.</p><h2 class="nj mn jl bm mo nk nl nm ms nn no np mw lz nq nr my md ns nt na mh nu nv nc nw ga" id="1600">Monitor descriptive statistics</h2><p class="pw-post-body-paragraph lq lr jl ls b lt ne km lv lw nf kp ly lz ng mb mc md nh mf mg mh ni mj mk ml je ga" id="ac05">We can describe our datasets statistically with measurements like min, max, median, mean, uniqueness, correlation, and others. We can include all these descriptive statistics in our model monitoring dashboard to visualize how these statistics change over time.</p><h2 class="nj mn jl bm mo nk nl nm ms nn no np mw lz nq nr my md ns nt na mh nu nv nc nw ga" id="3463">Monitor distribution changes</h2><p class="pw-post-body-paragraph lq lr jl ls b lt ne km lv lw nf kp ly lz ng mb mc md nh mf mg mh ni mj mk ml je ga" id="bdd8">When you see changes in the descriptive statistics, how do you know there are actual changes in the distributions and how do you know those changes are significant and meaningful? There are several statistical tests or hypothesis tests people use to detect the distribution changes statistically such as Population Stability Index, Kullback-Leibler (KL) divergence, Jensen-Shannon, Kolmogorov-Smirnov test, Cramér-von Mises, Fisher’s Exact Test, Maximum Mean Discrepancy (MMD), and Least-Squares Density Difference.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="5a1c">For example, <strong class="ls jm">Population Stability Index</strong> (<a class="au lp" href="https://mwburke.github.io/data%20science/2018/04/29/population-stability-index.html" rel="noopener ugc nofollow" target="_blank">PSI</a>) measures “how much a population has shifted over time or between two different samples of a population in a single number”. <strong class="ls jm">Kolmogorov-Smirnov test</strong> (or<a class="au lp" href="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test" rel="noopener ugc nofollow" target="_blank"> KS test</a>) “quantifies a distance between the empirical distribution function of the sample and the cumulative distribution function of the reference distribution, or between the empirical distribution functions of two samples”.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="539d">Furthermore, there are also supervised and unsupervised ML models designed for detecting model drift.</p><h1 class="mm mn jl bm mo mp mq mr ms mt mu mv mw kr mx ks my ku mz kv na kx nb ky nc nd ga" id="6f26">Mitigations</h1><p class="pw-post-body-paragraph lq lr jl ls b lt ne km lv lw nf kp ly lz ng mb mc md nh mf mg mh ni mj mk ml je ga" id="dc96">In practice, we often set up a model monitoring system to detect model drift. Other times, we discover data drift through model analysis when there is something wrong with our models. In either situation, when model drift happens, we first need to find the cause of the drift. What are the causes of the model drift? Different root causes should have different mitigation strategies. Please refer back to the “Causes of model drift” for details.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="05dc">Assuming our data is correct and validated, a common approach to mitigate model drift is to retrain the model with new data. You may wonder, why don’t we just retrain models all the time so that we don’t need to care about model drift? That’s a great question. In fact, a lot of companies do model retraining as much as they can. However, sometimes model retraining and deployment are not that straightforward. For example, your new data might not be labeled. Your newly trained model might not be better, especially when you have not done the drift analyses and are not sure where it went wrong in the first place.</p><h1 class="mm mn jl bm mo mp mq mr ms mt mu mv mw kr mx ks my ku mz kv na kx nb ky nc nd ga" id="bd1c">Tools</h1><p class="pw-post-body-paragraph lq lr jl ls b lt ne km lv lw nf kp ly lz ng mb mc md nh mf mg mh ni mj mk ml je ga" id="9286">There are a lot of ML monitoring tools and model drift monitoring tools out there. Here are a few popular tools:</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="96c4"><a class="au lp" href="https://github.com/whylabs/whylogs" rel="noopener ugc nofollow" target="_blank">whylogs</a> is an “open source library for logging any kind of data. With whylogs, users are able to generate summaries of their datasets (called whylogs profiles) which they can use to track changes in their dataset, create data constraints to know whether their data looks the way it should, and quickly visualize key summary statistics about their datasets.”</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="641e"><a class="au lp" href="https://github.com/evidentlyai/evidently" rel="noopener ugc nofollow" target="_blank">Evidently</a> is an “open-source framework to evaluate, test and monitor ML models in production.”</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="6a12"><a class="au lp" href="https://github.com/SeldonIO/alibi-detect" rel="noopener ugc nofollow" target="_blank">Alibi Detect</a> is an “open source Python library focused on outlier, adversarial and drift detection.”</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="58ad">All the major cloud providers and MLOps platforms also have their own model performance and model drift monitoring tools if you use those platforms. For example,<a class="au lp" href="https://aws.amazon.com/sagemaker/model-monitor/" rel="noopener ugc nofollow" target="_blank"> Amazon SageMaker Model Monitor</a> “detects data skew by comparing real-world data to a baseline dataset such as a training dataset or an evaluation dataset.”</p><h1 class="mm mn jl bm mo mp mq mr ms mt mu mv mw kr mx ks my ku mz kv na kx nb ky nc nd ga" id="492f">Conclusion</h1><p class="pw-post-body-paragraph lq lr jl ls b lt ne km lv lw nf kp ly lz ng mb mc md nh mf mg mh ni mj mk ml je ga" id="9a22">In your machine learning journey, designing a machine learning model is just the start. The real challenge follows once you have crafted your perfect machine learning model and deployed it into production. The model that works for the current data might not work for the future. A big component of continuous monitoring is model drift. Monitoring and mitigating model drift help to keep your machine learning model happy and successful!</p><h1 class="mm mn jl bm mo mp mq mr ms mt mu mv mw kr mx ks my ku mz kv na kx nb ky nc nd ga" id="477d">References:</h1><ul class=""><li class="ny nz jl ls b lt ne lw nf lz oa md ob mh oc ml od oe of og ga" id="8064"><a class="au lp" href="https://dl.acm.org/doi/10.1145/2523813" rel="noopener ugc nofollow" target="_blank">A survey on concept drift adaptation. <em class="oh">ACM computing surveys (CSUR)</em></a></li><li class="ny nz jl ls b lt oi lw oj lz ok md ol mh om ml od oe of og ga" id="7860">Quionero-Candela, Joaquin, et al. <em class="oh">Dataset shift in machine learning</em>. The MIT Press, 2009.</li><li class="ny nz jl ls b lt oi lw oj lz ok md ol mh om ml od oe of og ga" id="0d3d">Design Machine Learning System. Chip Huyen. 2022.</li><li class="ny nz jl ls b lt oi lw oj lz ok md ol mh om ml od oe of og ga" id="4710"><a class="au lp" href="https://www.fiddler.ai/blog/drift-in-machine-learning-how-to-identify-issues-before-you-have-a-problem" rel="noopener ugc nofollow" target="_blank">https://www.fiddler.ai/blog/drift-in-machine-learning-how-to-identify-issues-before-you-have-a-problem</a></li><li class="ny nz jl ls b lt oi lw oj lz ok md ol mh om ml od oe of og ga" id="3abc"><a class="au lp" href="https://mwburke.github.io/data science/2018/04/29/population-stability-index.html" rel="noopener ugc nofollow" target="_blank">https://mwburke.github.io/data science/2018/04/29/population-stability-index.html</a></li></ul><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="19b2">. . .</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="ad57">By Sophia Yang on August 23, 2022.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="00cc">Sophia Yang is a Senior Data Scientist at Anaconda. Connect with me on <a class="au lp" href="https://www.linkedin.com/in/sophiamyang/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>, <a class="au lp" href="https://twitter.com/sophiamyang" rel="noopener ugc nofollow" target="_blank">Twitter</a>, and <a class="au lp" href="https://www.youtube.com/SophiaYangDS" rel="noopener ugc nofollow" target="_blank">YouTube</a> and join the DS/ML <a class="au lp" href="https://discord.com/invite/6BremEf9db" rel="noopener ugc nofollow" target="_blank">Book Club</a> ❤️</p></div></div></section></div></div></article>