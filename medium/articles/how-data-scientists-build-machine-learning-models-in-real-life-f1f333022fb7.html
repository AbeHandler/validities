<article class="meteredContent"><div class="l"><div class="gg gh gi gj gk gl gm ce gn ch l"></div><div class="l"><header class="pw-post-byline-header go gp gq gr gs gt gu gv gw gx l"><div class="o gy u"><div class="o"><div class="fj l"><a class="au av aw ax ay az ba bb bc bd be bf bg bh bi" href="https://rahuldeb-das.medium.com/?source=post_page-----f1f333022fb7--------------------------------" rel="noopener follow"><div class="l do"><img alt="Rahuldeb Das, Ph. D" class="l ch fl gz ha fp" height="48" loading="lazy" src="https://miro.medium.com/fit/c/96/96/1*qM-uKgAjbo1xTG2wyOnqNA.jpeg" width="48"/><div class="fk fl l gz ha fo aq"></div></div></a></div><div class="l"><div class="pw-author bm b dm dn ga"><div class="hb o hc"><div><div aria-hidden="false" class="ci"><a class="au av aw ax ay az ba bb bc bd be bf bg bh bi" href="https://rahuldeb-das.medium.com/?source=post_page-----f1f333022fb7--------------------------------" rel="noopener follow">Rahuldeb Das, Ph. D</a></div></div><div class="hd he hf hg hh d"><span><a class="bm b hi bo hj hk hl hm hn ho hp bd bz hq hr hs cd cf cg ch ci cj" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb190dcd34e15&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-data-scientists-build-machine-learning-models-in-real-life-f1f333022fb7&amp;user=Rahuldeb+Das%2C+Ph.+D&amp;userId=b190dcd34e15&amp;source=post_page-b190dcd34e15----f1f333022fb7---------------------follow_byline-----------" rel="noopener follow">Follow</a></span></div></div></div><div class="o ao ht"><p class="pw-published-date bm b bn bo cn"><span>Sep 17, 2020</span></p><div aria-hidden="true" class="hu ci"><span aria-hidden="true" class="l"><span class="bm b bn bo cn">·</span></span></div><div class="pw-reading-time bm b bn bo cn">17 min read</div><div aria-hidden="true" class="hu ci"><span aria-hidden="true" class="l"><span class="bm b bn bo cn">·</span></span></div><div class="hx l"><div aria-hidden="false" class="l"><button class="l dz hv bb"><div class="j i d"><div><div aria-hidden="false" class="ci"><svg fill="none" height="20" viewbox="0 0 20 20" width="20"><path d="M12.4 12.77l-1.81 4.99a.63.63 0 0 1-1.18 0l-1.8-4.99a.63.63 0 0 0-.38-.37l-4.99-1.81a.62.62 0 0 1 0-1.18l4.99-1.8a.63.63 0 0 0 .37-.38l1.81-4.99a.63.63 0 0 1 1.18 0l1.8 4.99a.63.63 0 0 0 .38.37l4.99 1.81a.63.63 0 0 1 0 1.18l-4.99 1.8a.63.63 0 0 0-.37.38z" fill="#FFC017"></path></svg></div></div></div><div class="h k hy hz ia"><svg class="hw" fill="none" height="20" viewbox="0 0 20 20" width="20"><path d="M12.4 12.77l-1.81 4.99a.63.63 0 0 1-1.18 0l-1.8-4.99a.63.63 0 0 0-.38-.37l-4.99-1.81a.62.62 0 0 1 0-1.18l4.99-1.8a.63.63 0 0 0 .37-.38l1.81-4.99a.63.63 0 0 1 1.18 0l1.8 4.99a.63.63 0 0 0 .38.37l4.99 1.81a.63.63 0 0 1 0 1.18l-4.99 1.8a.63.63 0 0 0-.37.38z" fill="#FFC017"></path></svg><p class="bm b bn bo cn">Member-only</p></div></button></div></div></div></div></div><div class="o ao"><div class="h k ib ic id"><div class="ie l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on twitter" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M20 5.34c-.67.41-1.4.7-2.18.87a3.45 3.45 0 0 0-5.02-.1 3.49 3.49 0 0 0-1.02 2.47c0 .28.03.54.07.8a9.91 9.91 0 0 1-7.17-3.66 3.9 3.9 0 0 0-.5 1.74 3.6 3.6 0 0 0 1.56 2.92 3.36 3.36 0 0 1-1.55-.44V10c0 1.67 1.2 3.08 2.8 3.42-.3.06-.6.1-.94.12l-.62-.06a3.5 3.5 0 0 0 3.24 2.43 7.34 7.34 0 0 1-4.36 1.49l-.81-.05a9.96 9.96 0 0 0 5.36 1.56c6.4 0 9.91-5.32 9.9-9.9v-.5c.69-.49 1.28-1.1 1.74-1.81-.63.3-1.3.48-2 .56A3.33 3.33 0 0 0 20 5.33" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="ie l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on facebook" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M19.75 12.04c0-4.3-3.47-7.79-7.75-7.79a7.77 7.77 0 0 0-5.9 12.84 7.77 7.77 0 0 0 4.69 2.63v-5.49h-1.9v-2.2h1.9v-1.62c0-1.88 1.14-2.9 2.8-2.9.8 0 1.49.06 1.69.08v1.97h-1.15c-.91 0-1.1.43-1.1 1.07v1.4h2.17l-.28 2.2h-1.88v5.52a7.77 7.77 0 0 0 6.7-7.71" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="ie l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on linkedin" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M19.75 5.39v13.22a1.14 1.14 0 0 1-1.14 1.14H5.39a1.14 1.14 0 0 1-1.14-1.14V5.39a1.14 1.14 0 0 1 1.14-1.14h13.22a1.14 1.14 0 0 1 1.14 1.14zM8.81 10.18H6.53v7.3H8.8v-7.3zM9 7.67a1.31 1.31 0 0 0-1.3-1.32h-.04a1.32 1.32 0 0 0 0 2.64A1.31 1.31 0 0 0 9 7.71v-.04zm8.46 5.37c0-2.2-1.4-3.05-2.78-3.05a2.6 2.6 0 0 0-2.3 1.18h-.07v-1h-2.14v7.3h2.28V13.6a1.51 1.51 0 0 1 1.36-1.63h.09c.72 0 1.26.45 1.26 1.6v3.91h2.28l.02-4.43z" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="l fr"><div><div aria-hidden="false" class="ci"><button class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path clip-rule="evenodd" d="M3.57 14.67c0-.57.13-1.11.38-1.6l.02-.02v-.02l.02-.02c0-.02 0-.02.02-.02.12-.26.3-.52.57-.8L7.78 9v-.02l.01-.02c.44-.41.91-.7 1.44-.85a4.87 4.87 0 0 0-1.19 2.36A5.04 5.04 0 0 0 8 11.6L6.04 13.6c-.19.19-.32.4-.38.65a2 2 0 0 0 0 .9c.08.2.2.4.38.57l1.29 1.31c.27.28.62.42 1.03.42.42 0 .78-.14 1.06-.42l1.23-1.25.79-.78 1.15-1.16c.08-.09.19-.22.28-.4.1-.2.15-.42.15-.67 0-.16-.02-.3-.06-.45l-.02-.02v-.02l-.07-.14s0-.03-.04-.06l-.06-.13-.02-.02c0-.02 0-.03-.02-.05a.6.6 0 0 0-.14-.16l-.48-.5c0-.04.02-.1.04-.15l.06-.12 1.17-1.14.09-.09.56.57c.02.04.08.1.16.18l.05.04.03.06.04.05.03.04.04.06.1.14.02.02c0 .02.01.03.03.04l.1.2v.02c.1.16.2.38.3.68a1 1 0 0 1 .04.25 3.2 3.2 0 0 1 .02 1.33 3.49 3.49 0 0 1-.95 1.87l-.66.67-.97.97-1.56 1.57a3.4 3.4 0 0 1-2.47 1.02c-.97 0-1.8-.34-2.49-1.03l-1.3-1.3a3.55 3.55 0 0 1-1-2.51v-.01h-.02v.02zm5.39-3.43c0-.19.02-.4.07-.63.13-.74.44-1.37.95-1.87l.66-.67.97-.98 1.56-1.56c.68-.69 1.5-1.03 2.47-1.03.97 0 1.8.34 2.48 1.02l1.3 1.32a3.48 3.48 0 0 1 1 2.48c0 .58-.11 1.11-.37 1.6l-.02.02v.02l-.02.04c-.14.27-.35.54-.6.8L16.23 15l-.01.02-.01.02c-.44.42-.92.7-1.43.83a4.55 4.55 0 0 0 1.23-3.52L18 10.38c.18-.21.3-.42.35-.65a2.03 2.03 0 0 0-.01-.9 1.96 1.96 0 0 0-.36-.58l-1.3-1.3a1.49 1.49 0 0 0-1.06-.42c-.42 0-.77.14-1.06.4l-1.2 1.27-.8.8-1.16 1.15c-.08.08-.18.21-.29.4a1.66 1.66 0 0 0-.08 1.12l.02.03v.02l.06.14s.01.03.05.06l.06.13.02.02.01.02.01.02c.05.08.1.13.14.16l.47.5c0 .04-.02.09-.04.15l-.06.12-1.15 1.15-.1.08-.56-.56a2.3 2.3 0 0 0-.18-.19c-.02-.01-.02-.03-.02-.04l-.02-.02a.37.37 0 0 1-.1-.12c-.03-.03-.05-.04-.05-.06l-.1-.15-.02-.02-.02-.04-.08-.17v-.02a5.1 5.1 0 0 1-.28-.69 1.03 1.03 0 0 1-.04-.26c-.06-.23-.1-.46-.1-.7v.01z" fill="#A8A8A8" fill-rule="evenodd"></path></svg></span></button></div></div></div><div class="ih o ao"><span><a class="au av aw ax ay az ba bb bc bd be bf bg bh bi" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1f333022fb7&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-data-scientists-build-machine-learning-models-in-real-life-f1f333022fb7&amp;source=--------------------------bookmark_header-----------" rel="noopener follow"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" class="au de aw ax ay az ba if bc hv ij ik il"><svg aria-label="Add to list bookmark button" class="ii" fill="none" height="25" viewbox="0 0 25 25" width="25"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="#292929"></path></svg></button></a></span></div></div><div class="ck im"><div><div aria-hidden="false" class="ci"></div></div></div></div></div><div class="in io ip j i d"><div class="fj l"><span><a class="au av aw ax ay az ba bb bc bd be bf bg bh bi" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1f333022fb7&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-data-scientists-build-machine-learning-models-in-real-life-f1f333022fb7&amp;source=--------------------------bookmark_header-----------" rel="noopener follow"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" class="au de aw iq ay az ba ir bc hv cd o ao is it il"><svg aria-label="Add to list bookmark button" class="ii" fill="none" height="25" viewbox="0 0 25 25" width="25"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="#292929"></path></svg><p class="bm b bn bo cn">Save</p></button></a></span></div><div class="iu l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on twitter" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M20 5.34c-.67.41-1.4.7-2.18.87a3.45 3.45 0 0 0-5.02-.1 3.49 3.49 0 0 0-1.02 2.47c0 .28.03.54.07.8a9.91 9.91 0 0 1-7.17-3.66 3.9 3.9 0 0 0-.5 1.74 3.6 3.6 0 0 0 1.56 2.92 3.36 3.36 0 0 1-1.55-.44V10c0 1.67 1.2 3.08 2.8 3.42-.3.06-.6.1-.94.12l-.62-.06a3.5 3.5 0 0 0 3.24 2.43 7.34 7.34 0 0 1-4.36 1.49l-.81-.05a9.96 9.96 0 0 0 5.36 1.56c6.4 0 9.91-5.32 9.9-9.9v-.5c.69-.49 1.28-1.1 1.74-1.81-.63.3-1.3.48-2 .56A3.33 3.33 0 0 0 20 5.33" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="iu l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on facebook" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M19.75 12.04c0-4.3-3.47-7.79-7.75-7.79a7.77 7.77 0 0 0-5.9 12.84 7.77 7.77 0 0 0 4.69 2.63v-5.49h-1.9v-2.2h1.9v-1.62c0-1.88 1.14-2.9 2.8-2.9.8 0 1.49.06 1.69.08v1.97h-1.15c-.91 0-1.1.43-1.1 1.07v1.4h2.17l-.28 2.2h-1.88v5.52a7.77 7.77 0 0 0 6.7-7.71" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="iu l fr"><div><div aria-hidden="false" class="ci"><button aria-label="Share on linkedin" class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path d="M19.75 5.39v13.22a1.14 1.14 0 0 1-1.14 1.14H5.39a1.14 1.14 0 0 1-1.14-1.14V5.39a1.14 1.14 0 0 1 1.14-1.14h13.22a1.14 1.14 0 0 1 1.14 1.14zM8.81 10.18H6.53v7.3H8.8v-7.3zM9 7.67a1.31 1.31 0 0 0-1.3-1.32h-.04a1.32 1.32 0 0 0 0 2.64A1.31 1.31 0 0 0 9 7.71v-.04zm8.46 5.37c0-2.2-1.4-3.05-2.78-3.05a2.6 2.6 0 0 0-2.3 1.18h-.07v-1h-2.14v7.3h2.28V13.6a1.51 1.51 0 0 1 1.36-1.63h.09c.72 0 1.26.45 1.26 1.6v3.91h2.28l.02-4.43z" fill="#A8A8A8"></path></svg></span></button></div></div></div><div class="l fr"><div><div aria-hidden="false" class="ci"><button class="au av aw ax ay az ba bb bc bd be bf bg bh bi"><span class="ci if dw ig"><svg fill="none" height="24" viewbox="0 0 24 24" width="24"><path clip-rule="evenodd" d="M3.57 14.67c0-.57.13-1.11.38-1.6l.02-.02v-.02l.02-.02c0-.02 0-.02.02-.02.12-.26.3-.52.57-.8L7.78 9v-.02l.01-.02c.44-.41.91-.7 1.44-.85a4.87 4.87 0 0 0-1.19 2.36A5.04 5.04 0 0 0 8 11.6L6.04 13.6c-.19.19-.32.4-.38.65a2 2 0 0 0 0 .9c.08.2.2.4.38.57l1.29 1.31c.27.28.62.42 1.03.42.42 0 .78-.14 1.06-.42l1.23-1.25.79-.78 1.15-1.16c.08-.09.19-.22.28-.4.1-.2.15-.42.15-.67 0-.16-.02-.3-.06-.45l-.02-.02v-.02l-.07-.14s0-.03-.04-.06l-.06-.13-.02-.02c0-.02 0-.03-.02-.05a.6.6 0 0 0-.14-.16l-.48-.5c0-.04.02-.1.04-.15l.06-.12 1.17-1.14.09-.09.56.57c.02.04.08.1.16.18l.05.04.03.06.04.05.03.04.04.06.1.14.02.02c0 .02.01.03.03.04l.1.2v.02c.1.16.2.38.3.68a1 1 0 0 1 .04.25 3.2 3.2 0 0 1 .02 1.33 3.49 3.49 0 0 1-.95 1.87l-.66.67-.97.97-1.56 1.57a3.4 3.4 0 0 1-2.47 1.02c-.97 0-1.8-.34-2.49-1.03l-1.3-1.3a3.55 3.55 0 0 1-1-2.51v-.01h-.02v.02zm5.39-3.43c0-.19.02-.4.07-.63.13-.74.44-1.37.95-1.87l.66-.67.97-.98 1.56-1.56c.68-.69 1.5-1.03 2.47-1.03.97 0 1.8.34 2.48 1.02l1.3 1.32a3.48 3.48 0 0 1 1 2.48c0 .58-.11 1.11-.37 1.6l-.02.02v.02l-.02.04c-.14.27-.35.54-.6.8L16.23 15l-.01.02-.01.02c-.44.42-.92.7-1.43.83a4.55 4.55 0 0 0 1.23-3.52L18 10.38c.18-.21.3-.42.35-.65a2.03 2.03 0 0 0-.01-.9 1.96 1.96 0 0 0-.36-.58l-1.3-1.3a1.49 1.49 0 0 0-1.06-.42c-.42 0-.77.14-1.06.4l-1.2 1.27-.8.8-1.16 1.15c-.08.08-.18.21-.29.4a1.66 1.66 0 0 0-.08 1.12l.02.03v.02l.06.14s.01.03.05.06l.06.13.02.02.01.02.01.02c.05.08.1.13.14.16l.47.5c0 .04-.02.09-.04.15l-.06.12-1.15 1.15-.1.08-.56-.56a2.3 2.3 0 0 0-.18-.19c-.02-.01-.02-.03-.02-.04l-.02-.02a.37.37 0 0 1-.1-.12c-.03-.03-.05-.04-.05-.06l-.1-.15-.02-.02-.02-.04-.08-.17v-.02a5.1 5.1 0 0 1-.28-.69 1.03 1.03 0 0 1-.04-.26c-.06-.23-.1-.46-.1-.7v.01z" fill="#A8A8A8" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></header><span class="l"></span><section><div><div class="fo as ja jb jc jd"></div><div class="je jf jg jh ji"><div class=""><h1 class="pw-post-title jj jk jl bm jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ga" id="ba1f">How Data Scientists Build Machine Learning Models in Real Life</h1></div><div class=""><h2 class="pw-subtitle-paragraph ki jk jl bm b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz cn" id="954b">Steps for successful completion of a predictive model</h2></div><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="lg lh do li ce lj" role="button" tabindex="0"><div class="gl gm la"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/max/640/1*xTcU74Gqaqi-KTxv5up7uw.jpeg 640w, https://miro.medium.com/max/720/1*xTcU74Gqaqi-KTxv5up7uw.jpeg 720w, https://miro.medium.com/max/750/1*xTcU74Gqaqi-KTxv5up7uw.jpeg 750w, https://miro.medium.com/max/786/1*xTcU74Gqaqi-KTxv5up7uw.jpeg 786w, https://miro.medium.com/max/828/1*xTcU74Gqaqi-KTxv5up7uw.jpeg 828w, https://miro.medium.com/max/1100/1*xTcU74Gqaqi-KTxv5up7uw.jpeg 1100w, https://miro.medium.com/max/1400/1*xTcU74Gqaqi-KTxv5up7uw.jpeg 1400w"/><img alt="" class="ce lk ll c" height="525" loading="eager" role="presentation" width="700"/></picture></div></div><figcaption class="lm bl gn gl gm ln lo bm b bn bo cn">Photo by <a class="au lp" href="https://unsplash.com/@photoshobby?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Photos Hobby</a> on <a class="au lp" href="https://unsplash.com/s/photos/robot-hand?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="7b72">The web is already flooded by data science and machine learning related resources nowadays. There are numerous blogs, websites, YouTube videos, and forums that are providing useful information regarding data science related topics. Now it has become tedious to choose the right material for any data science quest.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="31bf">When I started my journey in data science, a few years back, I faced the same dilemma. But one thing I observed in most of these resources they are not complete. You have to traverse through a number of resources to get exhaustive information.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="d95a">Also, I saw a lack of real-life perspective of the articles written on machine learning models. So I thought of writing a post on the overall picture of building a machine learning model for any use case in real-life.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="8041">To perform any data science project, a data scientist needs to go through several steps. Broadly these steps can be presented as:</p><ol class=""><li class="mm mn jl ls b lt lu lw lx lz mo md mp mh mq ml mr ms mt mu ga" id="c950">Formulation of the data science problem from the given business problem</li></ol><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="a9a6">2. Data source exploration and data collection</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="a89e">3. Exploration of the variables (EDA)</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="0f76">4. Model building</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="3a4a">5. Model evaluation</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="0969">6. Model deployment</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="ea73">Steps 1 and 2 depend on the context of the problem. Step 6 depends more on the business requirement and the available infrastructure. And steps 2, 3, 4, and 5 are the sole responsibilities of a data scientist.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="2840">In this post, I shall discuss how to build a classification model end-to-end. I shall take you through the entire journey of a data scientist in any project that requires building a classification model. I shall try to organize this post in such a way that it can be readily adapted for similar situations.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="da8a">I used a Random Forst model to describe the methods. Even if you use any other classifier, the execution will be pretty similar.</p></div><div class="o dx mv mw in mx" role="separator"><span class="my fl ci mz na nb"></span><span class="my fl ci mz na nb"></span><span class="my fl ci mz na"></span></div><div class="je jf jg jh ji"><h1 class="nc nd jl bm ne nf ng nh ni nj nk nl nm kr nn ks no ku np kv nq kx nr ky ns nt ga" id="5c68">1. Formulation of a science problem from a given business problem</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nu km lv lw nv kp ly lz nw mb mc md nx mf mg mh ny mj mk ml je ga" id="f9a3">Usually, data science problems arise from business requirements. Business executives face various challenges in their process related to — product sales, profit margin, customer loyalty, procurement decisions, market share, and many other areas.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="38ea">These business problems will come to you as few business questions or as some observations by the business executives which they would like to verify.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="c50b">As a data scientist, it is your duty to convert those business problems into a data science problem and provide the answers meaningfully.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="c69f">In this post, I shall consider a simple problem of social network advertisement. The data set provides some variables that indicate the profiles of the customers. Also, it indicates the customers who have purchased the product.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="97d2">The aim of this assignment will be, based on the customer information, to predict who will purchase the product in the future.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="2331">So, as a data scientist, you need to understand that it is a classification problem with two classes — purchased and not-purchased.</p></div><div class="o dx mv mw in mx" role="separator"><span class="my fl ci mz na nb"></span><span class="my fl ci mz na nb"></span><span class="my fl ci mz na"></span></div><div class="je jf jg jh ji"><h1 class="nc nd jl bm ne nf ng nh ni nj nk nl nm kr nn ks no ku np kv nq kx nr ky ns nt ga" id="4100">2. Data source exploration and data collection</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nu km lv lw nv kp ly lz nw mb mc md nx mf mg mh ny mj mk ml je ga" id="2192">In real-life, data source exploration and data collection isn’t a simple task. In any organization, you will hardly find a single source where you will find all of your required data. Usually, you will find multiple disconnected sources of data and some of them will be hard to access because of infrastructure-related issues or because of restricted access.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="972b">Data collection from external sources also can be tricky because of cost issues and technical challenges.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="67cd">In this post, I have limited scope to demonstrate these issues. The data set for this discussion ‘social-network-ads’ is downloaded from <a class="au lp" href="https://www.kaggle.com/rakeshrau/social-network-ads" rel="noopener ugc nofollow" target="_blank">here</a>.</p></div><div class="o dx mv mw in mx" role="separator"><span class="my fl ci mz na nb"></span><span class="my fl ci mz na nb"></span><span class="my fl ci mz na"></span></div><div class="je jf jg jh ji"><h1 class="nc nd jl bm ne nf ng nh ni nj nk nl nm kr nn ks no ku np kv nq kx nr ky ns nt ga" id="6a4c">3. Exploration of the variables (EDA)</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nu km lv lw nv kp ly lz nw mb mc md nx mf mg mh ny mj mk ml je ga" id="52ef">Before jumping into Exploratory Data Analysis (EDA) you should always take a first look at the data. You should check few things — data volume, nature of different data coming from various sources, compatibility of the data sets, the mapping between them, data quality, data consistency — and most importantly the meaning of each variable and their business implications.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="d34e">Now it’s time to get the hands dirty with python codes using “social-network-ads” data. Since I have used single data set to keep this discussion simple, I have limited scope to illustrate all the aspects of the first look at the data I mentioned here.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="3248">The whole code can be executed in a jupyter notebook or any other python IDE of your choice. We will require several python libraries to complete this classification exercise. I shall first mention all the packages we need.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*TtgyLZ7_aknjOJmGB3gddw.png 640w, https://miro.medium.com/proxy/1*TtgyLZ7_aknjOJmGB3gddw.png 720w, https://miro.medium.com/proxy/1*TtgyLZ7_aknjOJmGB3gddw.png 750w, https://miro.medium.com/proxy/1*TtgyLZ7_aknjOJmGB3gddw.png 786w, https://miro.medium.com/proxy/1*TtgyLZ7_aknjOJmGB3gddw.png 828w, https://miro.medium.com/proxy/1*TtgyLZ7_aknjOJmGB3gddw.png 1100w, https://miro.medium.com/proxy/1*TtgyLZ7_aknjOJmGB3gddw.png 1400w"/><img alt="" class="lk ce ll c" loading="eager" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="6879">It is always a good idea to check your current working directory. If required change it to your preferred one.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*isENZkJ-YktMKQZ_esihAg.png 640w, https://miro.medium.com/proxy/1*isENZkJ-YktMKQZ_esihAg.png 720w, https://miro.medium.com/proxy/1*isENZkJ-YktMKQZ_esihAg.png 750w, https://miro.medium.com/proxy/1*isENZkJ-YktMKQZ_esihAg.png 786w, https://miro.medium.com/proxy/1*isENZkJ-YktMKQZ_esihAg.png 828w, https://miro.medium.com/proxy/1*isENZkJ-YktMKQZ_esihAg.png 1100w, https://miro.medium.com/proxy/1*isENZkJ-YktMKQZ_esihAg.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><h2 class="nz nd jl bm ne oa ob oc ni od oe of nm lz og oh no md oi oj nq mh ok ol ns om ga" id="16dd">First look at the data</h2><p class="pw-post-body-paragraph lq lr jl ls b lt nu km lv lw nv kp ly lz nw mb mc md nx mf mg mh ny mj mk ml je ga" id="d75e">Have a first look at your data that will be used to build the model. You will know how many variables you are dealing with and what those variables represent.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*PV71SQ6iYkaD1VcXd9hkpA.png 640w, https://miro.medium.com/proxy/1*PV71SQ6iYkaD1VcXd9hkpA.png 720w, https://miro.medium.com/proxy/1*PV71SQ6iYkaD1VcXd9hkpA.png 750w, https://miro.medium.com/proxy/1*PV71SQ6iYkaD1VcXd9hkpA.png 786w, https://miro.medium.com/proxy/1*PV71SQ6iYkaD1VcXd9hkpA.png 828w, https://miro.medium.com/proxy/1*PV71SQ6iYkaD1VcXd9hkpA.png 1100w, https://miro.medium.com/proxy/1*PV71SQ6iYkaD1VcXd9hkpA.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="1902">This is a small data set with only four hundred observations and five variables. Out of them, the “User ID” will not contribute to model development.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="0b0d">You should check for blank spaces in variable names. If you find any such cases, change the variable names. Blank spaces in variable names cause problems in the scripts. In this data, “User ID” had a blank space, and I changed it to “UserID”.</p><h2 class="nz nd jl bm ne oa ob oc ni od oe of nm lz og oh no md oi oj nq mh ok ol ns om ga" id="672e">The data types of the variables</h2><p class="pw-post-body-paragraph lq lr jl ls b lt nu km lv lw nv kp ly lz nw mb mc md nx mf mg mh ny mj mk ml je ga" id="f08b">Check the data type of each variable you are working with. The most common issues that arise in any data is with the date variable. I saw most of the time the date variables become “object” data type. Make sure you have converted it to date format. My current data does not contain any date-variable. Also, sometimes numerical variables become “object” types when some of their values contain characters or if some of them have missing values.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*EpxCme51EFxH-HzsquMPlQ.png 640w, https://miro.medium.com/proxy/1*EpxCme51EFxH-HzsquMPlQ.png 720w, https://miro.medium.com/proxy/1*EpxCme51EFxH-HzsquMPlQ.png 750w, https://miro.medium.com/proxy/1*EpxCme51EFxH-HzsquMPlQ.png 786w, https://miro.medium.com/proxy/1*EpxCme51EFxH-HzsquMPlQ.png 828w, https://miro.medium.com/proxy/1*EpxCme51EFxH-HzsquMPlQ.png 1100w, https://miro.medium.com/proxy/1*EpxCme51EFxH-HzsquMPlQ.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><h2 class="nz nd jl bm ne oa ob oc ni od oe of nm lz og oh no md oi oj nq mh ok ol ns om ga" id="b69a">Splitting the data into train, validation, and test set</h2><p class="pw-post-body-paragraph lq lr jl ls b lt nu km lv lw nv kp ly lz nw mb mc md nx mf mg mh ny mj mk ml je ga" id="0527">Before you process your data, split it into train, validation, and test set. Your model should only see the train set to train itself. The validation set should be only used to tune the parameters of the model by checking its performance on the validation set. The test set is used to check the performance of the model on the unseen data.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="1a10">All the statistical techniques you will use to process your train set should be used to process the validation and the test set. Also, the values of the statistics, you have estimated from the train set, should be used for the validation set and the test set.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="a72f">For example, if you have normalized a variable X of the train set by mean <strong class="ls jm"><em class="on">m</em></strong><em class="on"> </em>and standard deviation <strong class="ls jm"><em class="on">s</em></strong><em class="on">, </em>the same values should be used to normalize X in the validation set and the test set.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="6ac5">Now, the size of the train, validation, and test set depends on the available data volume. 80–10–10 or 70–20–10 are commonly used percentages of splitting train, validation, and test set when the data set is not large. But, if you have enough data, like millions, then keeping 2% or 1% or even 0.5% is good enough for the validation or test set.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*CMDMLNAjRkkHg9sDujXXhQ.png 640w, https://miro.medium.com/proxy/1*CMDMLNAjRkkHg9sDujXXhQ.png 720w, https://miro.medium.com/proxy/1*CMDMLNAjRkkHg9sDujXXhQ.png 750w, https://miro.medium.com/proxy/1*CMDMLNAjRkkHg9sDujXXhQ.png 786w, https://miro.medium.com/proxy/1*CMDMLNAjRkkHg9sDujXXhQ.png 828w, https://miro.medium.com/proxy/1*CMDMLNAjRkkHg9sDujXXhQ.png 1100w, https://miro.medium.com/proxy/1*CMDMLNAjRkkHg9sDujXXhQ.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="ee4f">From this data, I created a train set by taking 80% of the data. Kept 15% for the validation set and 5% for the test set.</p><h2 class="nz nd jl bm ne oa ob oc ni od oe of nm lz og oh no md oi oj nq mh ok ol ns om ga" id="aefc">Distribution of the variables</h2><p class="pw-post-body-paragraph lq lr jl ls b lt nu km lv lw nv kp ly lz nw mb mc md nx mf mg mh ny mj mk ml je ga" id="e889">Now it’s time to explore the train set and to understand the variables in hand.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="4512">A summary statistics of the variables will be helpful to understand their nature. You will have a rough idea about their distributions like — the range, whether they are skewed in nature, frequently appeared categories, etc.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*57kptETTVIp3A5RRQwlNTQ.png 640w, https://miro.medium.com/proxy/1*57kptETTVIp3A5RRQwlNTQ.png 720w, https://miro.medium.com/proxy/1*57kptETTVIp3A5RRQwlNTQ.png 750w, https://miro.medium.com/proxy/1*57kptETTVIp3A5RRQwlNTQ.png 786w, https://miro.medium.com/proxy/1*57kptETTVIp3A5RRQwlNTQ.png 828w, https://miro.medium.com/proxy/1*57kptETTVIp3A5RRQwlNTQ.png 1100w, https://miro.medium.com/proxy/1*57kptETTVIp3A5RRQwlNTQ.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="8201">In this data, the gender distribution is dominated by the females. The customer’s ages vary from 18 to 60 with an average of 38.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="82b7">Visualizations always help in understanding variables in greater depth.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*2NpncICOGJLUwiSOQqGyTQ.png 640w, https://miro.medium.com/proxy/1*2NpncICOGJLUwiSOQqGyTQ.png 720w, https://miro.medium.com/proxy/1*2NpncICOGJLUwiSOQqGyTQ.png 750w, https://miro.medium.com/proxy/1*2NpncICOGJLUwiSOQqGyTQ.png 786w, https://miro.medium.com/proxy/1*2NpncICOGJLUwiSOQqGyTQ.png 828w, https://miro.medium.com/proxy/1*2NpncICOGJLUwiSOQqGyTQ.png 1100w, https://miro.medium.com/proxy/1*2NpncICOGJLUwiSOQqGyTQ.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="ac35">A significant amount of customers are aged around 40. A large segment of customers falls in the lower salary buckets. As expected, the number of customers purchased in much lower than the total number of customers.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="bc9f">Checking the extent of the class imbalance is always a good idea for classification problems.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*oiPaI0J8KidPcs_PVxNQRA.png 640w, https://miro.medium.com/proxy/1*oiPaI0J8KidPcs_PVxNQRA.png 720w, https://miro.medium.com/proxy/1*oiPaI0J8KidPcs_PVxNQRA.png 750w, https://miro.medium.com/proxy/1*oiPaI0J8KidPcs_PVxNQRA.png 786w, https://miro.medium.com/proxy/1*oiPaI0J8KidPcs_PVxNQRA.png 828w, https://miro.medium.com/proxy/1*oiPaI0J8KidPcs_PVxNQRA.png 1100w, https://miro.medium.com/proxy/1*oiPaI0J8KidPcs_PVxNQRA.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="a751">In the train set, the ratio of purchased vs not-purchased is 38:62. So, the class imbalance is not that significant here.</p><h2 class="nz nd jl bm ne oa ob oc ni od oe of nm lz og oh no md oi oj nq mh ok ol ns om ga" id="64c9">Missing values and outliers</h2><p class="pw-post-body-paragraph lq lr jl ls b lt nu km lv lw nv kp ly lz nw mb mc md nx mf mg mh ny mj mk ml je ga" id="1580">Missing values is a sure (almost) phenomenon in real-file data. There are various techniques to deal with missing data — imputation by mean or median for a numeric variable, imputation by mode for a categorical variable, K- Nearest-Neighbors (KNN), regression, etc. Each of them works depending on the context.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="506b">In the current industry scenario, if some variable is present in your data, there can be two situations. Either you will have enough values of the variable or there will be no values at all. I hardly see a scenario in between.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="cae8">There are reasons for it. Organizations understood the importance of building processes and infrastructure to store data from different business operations. If they find some information crucial and there is a way to record it, they will store it properly. You will get enough information about it. But sometimes it becomes difficult to record a particular kind of information because of human bias or because of technical challenges. In this case, you will hardly get any information.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="01aa">So, I personally try out the deletion of missing values if I have enough data. If a variable has a significant amount of missing values, then dropping the variable may be a good idea. I only try imputation techniques when it is absolutely necessary.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="eb0d">Another frequently observed characteristic of real-life data is the presence of outliers. You can use upper and lower whiskers to determine outliers. Sometimes people treat lower 2.5 percent and upper 2.5 percent data as outliers. You need to check if they are really outliers before taking any action on them.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="b9f0">You can cap the outliers with some estimated upper and lower boundaries from the variables.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*VreRSY-7YfyGhhuatqzTAg.png 640w, https://miro.medium.com/proxy/1*VreRSY-7YfyGhhuatqzTAg.png 720w, https://miro.medium.com/proxy/1*VreRSY-7YfyGhhuatqzTAg.png 750w, https://miro.medium.com/proxy/1*VreRSY-7YfyGhhuatqzTAg.png 786w, https://miro.medium.com/proxy/1*VreRSY-7YfyGhhuatqzTAg.png 828w, https://miro.medium.com/proxy/1*VreRSY-7YfyGhhuatqzTAg.png 1100w, https://miro.medium.com/proxy/1*VreRSY-7YfyGhhuatqzTAg.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="121a">In this data set, there are no missing values. As the response variable in this data is categorical in nature, the concept of outliers is not suitable here.</p><h2 class="nz nd jl bm ne oa ob oc ni od oe of nm lz og oh no md oi oj nq mh ok ol ns om ga" id="c4f0">Feature creation</h2><p class="pw-post-body-paragraph lq lr jl ls b lt nu km lv lw nv kp ly lz nw mb mc md nx mf mg mh ny mj mk ml je ga" id="0c89">For most machine learning problems feature creation is a mandatory exercise. Sometimes the data available for model building does not contain enough variables. The available variables may not have sufficient explanatory power to boost the capability of the model. The data we are dealing with has only three variables — age, salary, and gender.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="a426">From these three variables, it will be difficult to build a model that will have enough predictive power. There may exist certain other factors that influence purchase decisions. Now, as we don’t have other information about the customers, we can use these variables judiciously to extract maximum possible explanatory power. For this, we need to create new variables (features) from the existing ones.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="65b8">There may exist another situation where we will have enough variables, but none of them showing adequate explanatory power. In that case, we need to create additional features form the original variables. Also, we may need to combine some variables intelligently to create new ones.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*BGd8EeVXN-jX3NMQm7ZfPA.png 640w, https://miro.medium.com/proxy/1*BGd8EeVXN-jX3NMQm7ZfPA.png 720w, https://miro.medium.com/proxy/1*BGd8EeVXN-jX3NMQm7ZfPA.png 750w, https://miro.medium.com/proxy/1*BGd8EeVXN-jX3NMQm7ZfPA.png 786w, https://miro.medium.com/proxy/1*BGd8EeVXN-jX3NMQm7ZfPA.png 828w, https://miro.medium.com/proxy/1*BGd8EeVXN-jX3NMQm7ZfPA.png 1100w, https://miro.medium.com/proxy/1*BGd8EeVXN-jX3NMQm7ZfPA.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*LIe5W6fdVD1ivnVyZ904dQ.png 640w, https://miro.medium.com/proxy/1*LIe5W6fdVD1ivnVyZ904dQ.png 720w, https://miro.medium.com/proxy/1*LIe5W6fdVD1ivnVyZ904dQ.png 750w, https://miro.medium.com/proxy/1*LIe5W6fdVD1ivnVyZ904dQ.png 786w, https://miro.medium.com/proxy/1*LIe5W6fdVD1ivnVyZ904dQ.png 828w, https://miro.medium.com/proxy/1*LIe5W6fdVD1ivnVyZ904dQ.png 1100w, https://miro.medium.com/proxy/1*LIe5W6fdVD1ivnVyZ904dQ.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="5b57">Here, customers are aged between 18 to 60. Instead of using age as variables, if we can identify the age buckets in which customers have different purchase pattern, it will have more explanatory power in determining whether a customer is going to purchase. Once we have identified the age buckets, we can form dummy variables for those buckets and use them as features.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="7ede">In this histogram, we see that the distribution of ages among the customers who have purchased differs from the customers who haven’t. The red rectangles, which represent the number of customers who have purchased, are higher in lower to middle age buckets. But the blue rectangles are higher for the high age buckets, which indicates the chance of not-purchased is more for higher age groups.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*aMC9DD9l4u2hVjVpLzSqZg.png 640w, https://miro.medium.com/proxy/1*aMC9DD9l4u2hVjVpLzSqZg.png 720w, https://miro.medium.com/proxy/1*aMC9DD9l4u2hVjVpLzSqZg.png 750w, https://miro.medium.com/proxy/1*aMC9DD9l4u2hVjVpLzSqZg.png 786w, https://miro.medium.com/proxy/1*aMC9DD9l4u2hVjVpLzSqZg.png 828w, https://miro.medium.com/proxy/1*aMC9DD9l4u2hVjVpLzSqZg.png 1100w, https://miro.medium.com/proxy/1*aMC9DD9l4u2hVjVpLzSqZg.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="ab6c">The understanding from the above histogram led to generate a new variable “age_group” that contains the age buckets instead of actual variable values. It will help us build new dummy variables for each age bucket.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*0RlgOcHyOJv4aBkdNB58bw.png 640w, https://miro.medium.com/proxy/1*0RlgOcHyOJv4aBkdNB58bw.png 720w, https://miro.medium.com/proxy/1*0RlgOcHyOJv4aBkdNB58bw.png 750w, https://miro.medium.com/proxy/1*0RlgOcHyOJv4aBkdNB58bw.png 786w, https://miro.medium.com/proxy/1*0RlgOcHyOJv4aBkdNB58bw.png 828w, https://miro.medium.com/proxy/1*0RlgOcHyOJv4aBkdNB58bw.png 1100w, https://miro.medium.com/proxy/1*0RlgOcHyOJv4aBkdNB58bw.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="b200">The same applies to the variable “EstimatedSalary” too. The salary of the customers varies from 15000 to 150000. I divided the range into nine buckets. Here you may have to experiment on how many buckets you should form. The target is to bring out an adequate number of buckets that differentiates the salary distribution between the purchased and not-purchased customers.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*OjYVgZEh7Bl065i7r0B-FQ.png 640w, https://miro.medium.com/proxy/1*OjYVgZEh7Bl065i7r0B-FQ.png 720w, https://miro.medium.com/proxy/1*OjYVgZEh7Bl065i7r0B-FQ.png 750w, https://miro.medium.com/proxy/1*OjYVgZEh7Bl065i7r0B-FQ.png 786w, https://miro.medium.com/proxy/1*OjYVgZEh7Bl065i7r0B-FQ.png 828w, https://miro.medium.com/proxy/1*OjYVgZEh7Bl065i7r0B-FQ.png 1100w, https://miro.medium.com/proxy/1*OjYVgZEh7Bl065i7r0B-FQ.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="b932">The variable “salary_group” is formed based on the pattern observed in the histogram.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*aRK8xy7Y2mHhNMuzcgcrig.png 640w, https://miro.medium.com/proxy/1*aRK8xy7Y2mHhNMuzcgcrig.png 720w, https://miro.medium.com/proxy/1*aRK8xy7Y2mHhNMuzcgcrig.png 750w, https://miro.medium.com/proxy/1*aRK8xy7Y2mHhNMuzcgcrig.png 786w, https://miro.medium.com/proxy/1*aRK8xy7Y2mHhNMuzcgcrig.png 828w, https://miro.medium.com/proxy/1*aRK8xy7Y2mHhNMuzcgcrig.png 1100w, https://miro.medium.com/proxy/1*aRK8xy7Y2mHhNMuzcgcrig.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="98fd">The distribution of gender does not differ significantly over customers’ purchased status. You must have noticed that female customers are slightly more inclined towards purchasing the products.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="f305">Once we explored all the variables in the data set, it’s time to finalize the features for the classification model. The features you will create for the train set, has to be exactly repeated for the validation set and the test set.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*PXR_XVHF-H8otvn2Jf9x2g.png 640w, https://miro.medium.com/proxy/1*PXR_XVHF-H8otvn2Jf9x2g.png 720w, https://miro.medium.com/proxy/1*PXR_XVHF-H8otvn2Jf9x2g.png 750w, https://miro.medium.com/proxy/1*PXR_XVHF-H8otvn2Jf9x2g.png 786w, https://miro.medium.com/proxy/1*PXR_XVHF-H8otvn2Jf9x2g.png 828w, https://miro.medium.com/proxy/1*PXR_XVHF-H8otvn2Jf9x2g.png 1100w, https://miro.medium.com/proxy/1*PXR_XVHF-H8otvn2Jf9x2g.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="1cbc">Thus we have created all the features and dummy variables for the model. I dropped the original variables, keeping only the dummies. While creating dummy variables I dropped one dummy variable from each group to avoid the dummy variable trap.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="8420">When we create dummy variables for any categorical variable, a dummy is created from each category. The Linear combination of all the dummies from a variable is always 1. As a result, they will be perfectly correlated with the intercept of the model. This is called the dummy variable trap. We avoid this by dropping one dummy for each categorical variable.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*Sj-mtoZbGgzQNHyz7uDFUg.png 640w, https://miro.medium.com/proxy/1*Sj-mtoZbGgzQNHyz7uDFUg.png 720w, https://miro.medium.com/proxy/1*Sj-mtoZbGgzQNHyz7uDFUg.png 750w, https://miro.medium.com/proxy/1*Sj-mtoZbGgzQNHyz7uDFUg.png 786w, https://miro.medium.com/proxy/1*Sj-mtoZbGgzQNHyz7uDFUg.png 828w, https://miro.medium.com/proxy/1*Sj-mtoZbGgzQNHyz7uDFUg.png 1100w, https://miro.medium.com/proxy/1*Sj-mtoZbGgzQNHyz7uDFUg.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*Gxu0fYbb2uFuu8lV-HzB_A.png 640w, https://miro.medium.com/proxy/1*Gxu0fYbb2uFuu8lV-HzB_A.png 720w, https://miro.medium.com/proxy/1*Gxu0fYbb2uFuu8lV-HzB_A.png 750w, https://miro.medium.com/proxy/1*Gxu0fYbb2uFuu8lV-HzB_A.png 786w, https://miro.medium.com/proxy/1*Gxu0fYbb2uFuu8lV-HzB_A.png 828w, https://miro.medium.com/proxy/1*Gxu0fYbb2uFuu8lV-HzB_A.png 1100w, https://miro.medium.com/proxy/1*Gxu0fYbb2uFuu8lV-HzB_A.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="3e4a">It is always a good idea to check the correlation structure of the variables. Multicollinearity makes it difficult to understand the significance of the features in the model.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="d689">Correlation among the created features does not seem to be very strong in our case.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*4lGnCaA6s15Lnh5AphrtoQ.png 640w, https://miro.medium.com/proxy/1*4lGnCaA6s15Lnh5AphrtoQ.png 720w, https://miro.medium.com/proxy/1*4lGnCaA6s15Lnh5AphrtoQ.png 750w, https://miro.medium.com/proxy/1*4lGnCaA6s15Lnh5AphrtoQ.png 786w, https://miro.medium.com/proxy/1*4lGnCaA6s15Lnh5AphrtoQ.png 828w, https://miro.medium.com/proxy/1*4lGnCaA6s15Lnh5AphrtoQ.png 1100w, https://miro.medium.com/proxy/1*4lGnCaA6s15Lnh5AphrtoQ.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="b686">And the train set is finally ready for model building.</p></div><div class="o dx mv mw in mx" role="separator"><span class="my fl ci mz na nb"></span><span class="my fl ci mz na nb"></span><span class="my fl ci mz na"></span></div><div class="je jf jg jh ji"><h1 class="nc nd jl bm ne nf ng nh ni nj nk nl nm kr nn ks no ku np kv nq kx nr ky ns nt ga" id="e35e">4. Model building</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nu km lv lw nv kp ly lz nw mb mc md nx mf mg mh ny mj mk ml je ga" id="b6ab">Before we train the model, we need the validation data to be ready for model validation. The same methods needed to apply to the validation set that we used for the train set.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="7492">At the same time, we can prepare the test data too and keep it for future use.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*wOcTLH7KNAB6711dY5mTtg.png 640w, https://miro.medium.com/proxy/1*wOcTLH7KNAB6711dY5mTtg.png 720w, https://miro.medium.com/proxy/1*wOcTLH7KNAB6711dY5mTtg.png 750w, https://miro.medium.com/proxy/1*wOcTLH7KNAB6711dY5mTtg.png 786w, https://miro.medium.com/proxy/1*wOcTLH7KNAB6711dY5mTtg.png 828w, https://miro.medium.com/proxy/1*wOcTLH7KNAB6711dY5mTtg.png 1100w, https://miro.medium.com/proxy/1*wOcTLH7KNAB6711dY5mTtg.png 1400w"/><img alt="" class="lk ce ll c" loading="eager" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="4a78">We created similar age buckets and salary buckets as we did for the train set. One thing you must check that all the classes of the target variable should be present in the validation set. If not, repeat the train-validation-test split.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*mht5Ox-OoWNmYsIypEVuHA.png 640w, https://miro.medium.com/proxy/1*mht5Ox-OoWNmYsIypEVuHA.png 720w, https://miro.medium.com/proxy/1*mht5Ox-OoWNmYsIypEVuHA.png 750w, https://miro.medium.com/proxy/1*mht5Ox-OoWNmYsIypEVuHA.png 786w, https://miro.medium.com/proxy/1*mht5Ox-OoWNmYsIypEVuHA.png 828w, https://miro.medium.com/proxy/1*mht5Ox-OoWNmYsIypEVuHA.png 1100w, https://miro.medium.com/proxy/1*mht5Ox-OoWNmYsIypEVuHA.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="31c9">We have created the same features for the validation set and the test set.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="4cb8">There are several algorithms for dealing with classification problems. It is not very convenient to know beforehand which model will perform better. We always try several models and compare their performances. In real-life scenarios, performance parameters can be prediction accuracy, execution time, and resource consumption.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*Hc9pS-gaBJWtXVme4QuiOQ.png 640w, https://miro.medium.com/proxy/1*Hc9pS-gaBJWtXVme4QuiOQ.png 720w, https://miro.medium.com/proxy/1*Hc9pS-gaBJWtXVme4QuiOQ.png 750w, https://miro.medium.com/proxy/1*Hc9pS-gaBJWtXVme4QuiOQ.png 786w, https://miro.medium.com/proxy/1*Hc9pS-gaBJWtXVme4QuiOQ.png 828w, https://miro.medium.com/proxy/1*Hc9pS-gaBJWtXVme4QuiOQ.png 1100w, https://miro.medium.com/proxy/1*Hc9pS-gaBJWtXVme4QuiOQ.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="5cb3">Here I have used a Random Forest model as a classifier. Random Forest builds several decision trees by sampling features from the train set. Each of these trees classifies the observations. Random Forest combines these decisions and extracts the most likely one. This is method is called bagging.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*GEJ3d7k-bR-LFSIT6s44Mw.png 640w, https://miro.medium.com/proxy/1*GEJ3d7k-bR-LFSIT6s44Mw.png 720w, https://miro.medium.com/proxy/1*GEJ3d7k-bR-LFSIT6s44Mw.png 750w, https://miro.medium.com/proxy/1*GEJ3d7k-bR-LFSIT6s44Mw.png 786w, https://miro.medium.com/proxy/1*GEJ3d7k-bR-LFSIT6s44Mw.png 828w, https://miro.medium.com/proxy/1*GEJ3d7k-bR-LFSIT6s44Mw.png 1100w, https://miro.medium.com/proxy/1*GEJ3d7k-bR-LFSIT6s44Mw.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="b7d0">I have used default parameters to build the model. You can further optimize the classifier using the parameters like — <em class="on">n_estimators, max_depth, min_samples_split, </em>min_samples_leaf, etc.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="7dfb">Save your model as a pickle file for future use. You should save the models with proper version names so that you can distinguish them when you will revisit them.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*ZCmjyEvao8AuoQ5ou3mO1Q.png 640w, https://miro.medium.com/proxy/1*ZCmjyEvao8AuoQ5ou3mO1Q.png 720w, https://miro.medium.com/proxy/1*ZCmjyEvao8AuoQ5ou3mO1Q.png 750w, https://miro.medium.com/proxy/1*ZCmjyEvao8AuoQ5ou3mO1Q.png 786w, https://miro.medium.com/proxy/1*ZCmjyEvao8AuoQ5ou3mO1Q.png 828w, https://miro.medium.com/proxy/1*ZCmjyEvao8AuoQ5ou3mO1Q.png 1100w, https://miro.medium.com/proxy/1*ZCmjyEvao8AuoQ5ou3mO1Q.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="f746">I saved the model in my work directory and then loaded it again as I am using a single notebook.</p></div><div class="o dx mv mw in mx" role="separator"><span class="my fl ci mz na nb"></span><span class="my fl ci mz na nb"></span><span class="my fl ci mz na"></span></div><div class="je jf jg jh ji"><h1 class="nc nd jl bm ne nf ng nh ni nj nk nl nm kr nn ks no ku np kv nq kx nr ky ns nt ga" id="c97a">5. Model evaluation</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nu km lv lw nv kp ly lz nw mb mc md nx mf mg mh ny mj mk ml je ga" id="9e0c">We arrived at a point where we have to answer a few questions like — How good the model is? Does it match our expectations? If not, what to do?</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*sEWfkp6yHZThEDmIOzdTNg.png 640w, https://miro.medium.com/proxy/1*sEWfkp6yHZThEDmIOzdTNg.png 720w, https://miro.medium.com/proxy/1*sEWfkp6yHZThEDmIOzdTNg.png 750w, https://miro.medium.com/proxy/1*sEWfkp6yHZThEDmIOzdTNg.png 786w, https://miro.medium.com/proxy/1*sEWfkp6yHZThEDmIOzdTNg.png 828w, https://miro.medium.com/proxy/1*sEWfkp6yHZThEDmIOzdTNg.png 1100w, https://miro.medium.com/proxy/1*sEWfkp6yHZThEDmIOzdTNg.png 1400w"/><img alt="" class="lk ce ll c" loading="eager" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="b175">To check the model, I have used the validation data set. The target classes of the validation set have been predicted. To judge how good the model is, we need to use some metrics of judgment.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="8317">The confusion matrix is a good way to represent the model performance. It shows the counts of positive and negative classes in the actual data and predicted results. Here positive class means the class with the label “Purchased” which is denoted by 1.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*rSMM3CUwGxJr0s8jQ2NdPg.png 640w, https://miro.medium.com/proxy/1*rSMM3CUwGxJr0s8jQ2NdPg.png 720w, https://miro.medium.com/proxy/1*rSMM3CUwGxJr0s8jQ2NdPg.png 750w, https://miro.medium.com/proxy/1*rSMM3CUwGxJr0s8jQ2NdPg.png 786w, https://miro.medium.com/proxy/1*rSMM3CUwGxJr0s8jQ2NdPg.png 828w, https://miro.medium.com/proxy/1*rSMM3CUwGxJr0s8jQ2NdPg.png 1100w, https://miro.medium.com/proxy/1*rSMM3CUwGxJr0s8jQ2NdPg.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*mX56dmWnYvfzekgbwG9Ccw.png 640w, https://miro.medium.com/proxy/1*mX56dmWnYvfzekgbwG9Ccw.png 720w, https://miro.medium.com/proxy/1*mX56dmWnYvfzekgbwG9Ccw.png 750w, https://miro.medium.com/proxy/1*mX56dmWnYvfzekgbwG9Ccw.png 786w, https://miro.medium.com/proxy/1*mX56dmWnYvfzekgbwG9Ccw.png 828w, https://miro.medium.com/proxy/1*mX56dmWnYvfzekgbwG9Ccw.png 1100w, https://miro.medium.com/proxy/1*mX56dmWnYvfzekgbwG9Ccw.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="dfcb">The above function provides a way to represent the confusion matrix with nice visualization. The function can visualize the confusion matrix with normalization (percentage figures) or without normalization (counts).</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*ZQ7DLlhRvE9-yRsfitTxXQ.png 640w, https://miro.medium.com/proxy/1*ZQ7DLlhRvE9-yRsfitTxXQ.png 720w, https://miro.medium.com/proxy/1*ZQ7DLlhRvE9-yRsfitTxXQ.png 750w, https://miro.medium.com/proxy/1*ZQ7DLlhRvE9-yRsfitTxXQ.png 786w, https://miro.medium.com/proxy/1*ZQ7DLlhRvE9-yRsfitTxXQ.png 828w, https://miro.medium.com/proxy/1*ZQ7DLlhRvE9-yRsfitTxXQ.png 1100w, https://miro.medium.com/proxy/1*ZQ7DLlhRvE9-yRsfitTxXQ.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="7db8">This matrix represents the true label and predicted label with their counts. For 17 observations out of 19, the true and predicted labels are the same for the class 1. That means, out of 19 customers who have purchased the model can predict 17. The same for the class not-purchased is 37 out of 41.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="aa65">To make it more concise, we have metrics like — precision, recall, F1-Score, accuracy, etc. For the classification models with imbalance class (the distribution of classes is not uniform), precision and recall are the matrics we rely on. The higher the measures are, the better the model is.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="4669">Precision is calculated by the ratio of two values. The number of customers for whom the model has predicted as “purchased”. And the number of customers who actually have purchased the product.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="5212">Recall expresses — among the customers who have actually purchased, how many of them have been correctly identified by the model.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="8e4d">Now, it is difficult to maximize precision and recall together. F1-Score is a measure that saves us from this situation. It is the harmonic mean of precision and recall. It helps us to keeps a balance between them.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*a-lqAcOi-6uu86H_-tSo7A.png 640w, https://miro.medium.com/proxy/1*a-lqAcOi-6uu86H_-tSo7A.png 720w, https://miro.medium.com/proxy/1*a-lqAcOi-6uu86H_-tSo7A.png 750w, https://miro.medium.com/proxy/1*a-lqAcOi-6uu86H_-tSo7A.png 786w, https://miro.medium.com/proxy/1*a-lqAcOi-6uu86H_-tSo7A.png 828w, https://miro.medium.com/proxy/1*a-lqAcOi-6uu86H_-tSo7A.png 1100w, https://miro.medium.com/proxy/1*a-lqAcOi-6uu86H_-tSo7A.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="2f7a">The model algorithm does not provide the target classes directly. It provides the probability of belonging to each class. If the probability of positive class is more than 0.5 then it is labeled as 1 otherwise 0.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="9449">This threshold value of probability can be optimized. We can check among all the thresholds which one provides the best classification result. It can be done by the precision-recall curve.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*GK14mzjA95vwqIkbyt8_9Q.png 640w, https://miro.medium.com/proxy/1*GK14mzjA95vwqIkbyt8_9Q.png 720w, https://miro.medium.com/proxy/1*GK14mzjA95vwqIkbyt8_9Q.png 750w, https://miro.medium.com/proxy/1*GK14mzjA95vwqIkbyt8_9Q.png 786w, https://miro.medium.com/proxy/1*GK14mzjA95vwqIkbyt8_9Q.png 828w, https://miro.medium.com/proxy/1*GK14mzjA95vwqIkbyt8_9Q.png 1100w, https://miro.medium.com/proxy/1*GK14mzjA95vwqIkbyt8_9Q.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="0dd8">So, instead of predicting the classes directly, I have extracted from the model the probabilities for each observation of the validation set. Using the precision-recall curve, the best threshold of probability has been found as 0.332714.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*yl3Ish_BVIhgwX6EVPsqQw.png 640w, https://miro.medium.com/proxy/1*yl3Ish_BVIhgwX6EVPsqQw.png 720w, https://miro.medium.com/proxy/1*yl3Ish_BVIhgwX6EVPsqQw.png 750w, https://miro.medium.com/proxy/1*yl3Ish_BVIhgwX6EVPsqQw.png 786w, https://miro.medium.com/proxy/1*yl3Ish_BVIhgwX6EVPsqQw.png 828w, https://miro.medium.com/proxy/1*yl3Ish_BVIhgwX6EVPsqQw.png 1100w, https://miro.medium.com/proxy/1*yl3Ish_BVIhgwX6EVPsqQw.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="4992">The graph visualizes the best threshold in the precision-recall curve. It optimizes both precisions and recalls for the predictions.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="1306">There are several other methods of model evaluation and parameter tuning. I could not get into all those to keep the discussion simple.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="7b7d">Model training and evaluation are recursive processes. You need to revisit the training and evaluation number of times to take it to a satisfactory level. Every time you need to tune the parameters of the model if the evaluation process does not reveal satisfactory results. I avoided this part in this article.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="ec7c">Now, it time to check how the model performs on the unseen test data. It will resemble how the model is going to perform if it is deployed into a real-life application.</p><h2 class="nz nd jl bm ne oa ob oc ni od oe of nm lz og oh no md oi oj nq mh ok ol ns om ga" id="3f32">Model evaluation on the test set</h2><p class="pw-post-body-paragraph lq lr jl ls b lt nu km lv lw nv kp ly lz nw mb mc md nx mf mg mh ny mj mk ml je ga" id="a159">Before using the model for prediction on the test set, you must check the shape of the test set. Ensure that the number of features present in the test set is equal to the number in the train set.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*JyOVgKf6_VwbOsO9PiTbgA.png 640w, https://miro.medium.com/proxy/1*JyOVgKf6_VwbOsO9PiTbgA.png 720w, https://miro.medium.com/proxy/1*JyOVgKf6_VwbOsO9PiTbgA.png 750w, https://miro.medium.com/proxy/1*JyOVgKf6_VwbOsO9PiTbgA.png 786w, https://miro.medium.com/proxy/1*JyOVgKf6_VwbOsO9PiTbgA.png 828w, https://miro.medium.com/proxy/1*JyOVgKf6_VwbOsO9PiTbgA.png 1100w, https://miro.medium.com/proxy/1*JyOVgKf6_VwbOsO9PiTbgA.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="9a61">In our case, three features were missing in the test set. Those are the dummy variables created from the estimated salary. As those salary buckets were absent in the test set, I inserted the dummies with zeros for them.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*K5aZ_kFvPbMfS0N_5ZVV0w.png 640w, https://miro.medium.com/proxy/1*K5aZ_kFvPbMfS0N_5ZVV0w.png 720w, https://miro.medium.com/proxy/1*K5aZ_kFvPbMfS0N_5ZVV0w.png 750w, https://miro.medium.com/proxy/1*K5aZ_kFvPbMfS0N_5ZVV0w.png 786w, https://miro.medium.com/proxy/1*K5aZ_kFvPbMfS0N_5ZVV0w.png 828w, https://miro.medium.com/proxy/1*K5aZ_kFvPbMfS0N_5ZVV0w.png 1100w, https://miro.medium.com/proxy/1*K5aZ_kFvPbMfS0N_5ZVV0w.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*bLw1StwW5AbiHJ30PQ4wFw.png 640w, https://miro.medium.com/proxy/1*bLw1StwW5AbiHJ30PQ4wFw.png 720w, https://miro.medium.com/proxy/1*bLw1StwW5AbiHJ30PQ4wFw.png 750w, https://miro.medium.com/proxy/1*bLw1StwW5AbiHJ30PQ4wFw.png 786w, https://miro.medium.com/proxy/1*bLw1StwW5AbiHJ30PQ4wFw.png 828w, https://miro.medium.com/proxy/1*bLw1StwW5AbiHJ30PQ4wFw.png 1100w, https://miro.medium.com/proxy/1*bLw1StwW5AbiHJ30PQ4wFw.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="42c7">I used the threshold probability, estimated in the validation set, to predict for the observation in the test set.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*7Azu5OYB96-FogxcG39p9w.png 640w, https://miro.medium.com/proxy/1*7Azu5OYB96-FogxcG39p9w.png 720w, https://miro.medium.com/proxy/1*7Azu5OYB96-FogxcG39p9w.png 750w, https://miro.medium.com/proxy/1*7Azu5OYB96-FogxcG39p9w.png 786w, https://miro.medium.com/proxy/1*7Azu5OYB96-FogxcG39p9w.png 828w, https://miro.medium.com/proxy/1*7Azu5OYB96-FogxcG39p9w.png 1100w, https://miro.medium.com/proxy/1*7Azu5OYB96-FogxcG39p9w.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="c7ad">The confusion matrix shows that all the customers with the “Purchased” label have been predicted correctly. So, the recall value is 1.</p><figure class="lb lc ld le gx lf gl gm paragraph-image"><div class="o gy dx cm"><picture><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/proxy/1*guN7KfRPf0vVVMT0j6io2w.png 640w, https://miro.medium.com/proxy/1*guN7KfRPf0vVVMT0j6io2w.png 720w, https://miro.medium.com/proxy/1*guN7KfRPf0vVVMT0j6io2w.png 750w, https://miro.medium.com/proxy/1*guN7KfRPf0vVVMT0j6io2w.png 786w, https://miro.medium.com/proxy/1*guN7KfRPf0vVVMT0j6io2w.png 828w, https://miro.medium.com/proxy/1*guN7KfRPf0vVVMT0j6io2w.png 1100w, https://miro.medium.com/proxy/1*guN7KfRPf0vVVMT0j6io2w.png 1400w"/><img alt="" class="lk ce ll c" loading="lazy" role="presentation" width="700"/></picture></div></figure><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="b2f4">The F1-Score for the set is 0.85. I would say that the model is providing us a decent performance. And we achieved that with a pretty straightforward and simple approach.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="05e1">An 85% F1-Score could be an excellent performance in many situations. However, the required accuracy from a model depends on various factors.</p></div><div class="o dx mv mw in mx" role="separator"><span class="my fl ci mz na nb"></span><span class="my fl ci mz na nb"></span><span class="my fl ci mz na"></span></div><div class="je jf jg jh ji"><h1 class="nc nd jl bm ne nf ng nh ni nj nk nl nm kr nn ks no ku np kv nq kx nr ky ns nt ga" id="f0a1">6. Model deployment</h1><p class="pw-post-body-paragraph lq lr jl ls b lt nu km lv lw nv kp ly lz nw mb mc md nx mf mg mh ny mj mk ml je ga" id="419c">Once you are satisfied with your model performance, you should check it with the business executives. You need to have a detailed discussion about the implication of your results and if it aligns with the business understandings.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="1cf0">Also, you need to confirm with business executives about the desired accuracy level. Decisions have to be made on deployment strategy, frequency of model revision, mode of delivery of the output, etc.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="0c63">It may happen that your model output will be consumed by other applications or even it might go to the business people in the form of a CSV file.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="cd0a">The way I represented the code in this article is more of a discrete manner. In real-life situations, we prefer to segment the script in different blocks and to use classes and functions to organize them.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="1c4a">Also, a separate script module is required to be prepared for the inference of the model. This script will fetch the data from a particular data storage, draw inference on the data, and save the output in a specified output location.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="e6b4">You will need a scheduler for the model to run after a specific interval. If other applications are depending on the output of this model, you need to synchronize them in the right order.</p></div><div class="o dx mv mw in mx" role="separator"><span class="my fl ci mz na nb"></span><span class="my fl ci mz na nb"></span><span class="my fl ci mz na"></span></div><div class="je jf jg jh ji"><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="9dc7">It is really hard to bring all the aspects of the machine learning projects in a single article. I tried my best to cover most of them. I might have missed some facts to mention here. But I believe I have been able to bring a summary of the entire journey in front of you.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="7b08">Data science is an emerging field. Many aspirants are joining the data science industry in the pursuit of becoming a data scientist. I hope this article will help them get a fair idea about the steps a data science project involves.</p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="12a0"><strong class="ls jm">You can download the notebook from </strong><a class="au lp" href="https://github.com/rahuldeb-das/classification-model/blob/master/Classification_model_example.ipynb" rel="noopener ugc nofollow" target="_blank"><strong class="ls jm">here</strong></a><strong class="ls jm">.</strong></p><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="bdf3"><strong class="ls jm">References:</strong></p><ol class=""><li class="mm mn jl ls b lt lu lw lx lz mo md mp mh mq ml mr ms mt mu ga" id="3610"><a class="au lp" href="https://machinelearningmastery.com/roc-curves-and-precision-recall-curves-for-imbalanced-classification/" rel="noopener ugc nofollow" target="_blank">https://machinelearningmastery.com/roc-curves-and-precision-recall-curves-for-imbalanced-classification/</a></li></ol><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="c029">2. <a class="au lp" href="https://stackoverflow.com/questions/19233771/sklearn-plot-confusion-matrix-with-labels/48018785" rel="noopener ugc nofollow" target="_blank">https://stackoverflow.com/questions/19233771/sklearn-plot-confusion-matrix-with-labels/48018785</a></p></div><div class="o dx mv mw in mx" role="separator"><span class="my fl ci mz na nb"></span><span class="my fl ci mz na nb"></span><span class="my fl ci mz na"></span></div><div class="je jf jg jh ji"><p class="pw-post-body-paragraph lq lr jl ls b lt lu km lv lw lx kp ly lz ma mb mc md me mf mg mh mi mj mk ml je ga" id="0a9b">Thank you for reading my article. If you liked this article, you might like my other articles. Here are some of them.</p><div class="oo op gt gv oq or"><a href="https://medium.com/swlh/how-to-learn-new-programming-language-with-no-books-and-tutorials-862e8cf77d8f" rel="noopener follow" target="_blank"><div class="os o fr"><div class="ot o da dx en ou"><h2 class="bm jm dm bo fs ov fu fv ow fx fz jk ga">How to Learn New Programming Language With No Books and Tutorials</h2><div class="ox l"><h3 class="bm b dm bo fs ov fu fv ow fx fz cn">A tested recipe for fast learning</h3></div><div class="oy l"><p class="bm b hi bo fs ov fu fv ow fx fz cn">medium.com</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe lk or"></div></div></div></a></div><div class="oo op gt gv oq or"><a href="/how-to-set-up-your-system-for-object-detection-models-2e0726212c4e" rel="noopener follow" target="_blank"><div class="os o fr"><div class="ot o da dx en ou"><h2 class="bm jm dm bo fs ov fu fv ow fx fz jk ga">How To Set Up Your System for Object Detection Models</h2><div class="ox l"><h3 class="bm b dm bo fs ov fu fv ow fx fz cn">You should start from the end to do it right at your first attempt</h3></div><div class="oy l"><p class="bm b hi bo fs ov fu fv ow fx fz cn">towardsdatascience.com</p></div></div><div class="oz l"><div class="pf l pb pc pd oz pe lk or"></div></div></div></a></div></div></div></section></div></div></article>